/**
 * Parvus
 *
 * @author Benjamin de Oostfrees
 * @version 2.4.0
 * @url https://github.com/deoostfrees/parvus
 *
 * MIT license
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Parvus=t()}(this,(function(){"use strict";var e={lightboxLabel:"This is a dialog window that overlays the main content of the page. The modal displays the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",lightboxLoadingError:"The requested image cannot be loaded.",controlsLabel:"Controls",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window",sliderLabel:"Images",slideLabel:"Image"};return function(t){const r=window,s=['a:not([inert]):not([tabindex^="-"])','button:not([inert]):not([tabindex^="-"]):not(:disabled)','[tabindex]:not([inert]):not([tabindex^="-"])'],i={triggerElements:[],slider:null,sliderElements:[],contentElements:[]},n={};let a=0,o=null,l=null,d=0,u={},c=null,m=null,p=1,h=null,g=null,b=null,v=null,f=null,E=null,A=null,y=null,w={},L=!1,_=!1,x=!1,C=null,$=null,k=null,I=!1,T=null,S=!0;const M=window.matchMedia("(prefers-reduced-motion)"),B=()=>{M.matches?(S=!0,T=.1):(S=!1,T=u.transitionDuration)};M.addEventListener("change",B);const N=e=>{const t=e.dataset.group||`default-${a}`;return++a,e.hasAttribute("data-group")||e.setAttribute("data-group",t),t},q=e=>{if(!("A"===e.tagName&&e.hasAttribute("href")||"BUTTON"===e.tagName&&e.hasAttribute("data-target")))throw new Error("Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file.");if(o=N(e),n[o]||(n[o]=structuredClone(i)),n[o].triggerElements.includes(e))throw new Error("Ups, element already added.");if(n[o].triggerElements.push(e),(e=>{if(e.querySelector("img")){const t=document.createElement("div");e.classList.add("parvus-zoom"),t.className="parvus-zoom__indicator",t.innerHTML=u.lightboxIndicatorIcon,e.appendChild(t)}})(e),e.classList.add("parvus-trigger"),e.addEventListener("click",re),be()&&o===l){const t=n[o].triggerElements.indexOf(e);X(t),O(e,t,(()=>{P(t)})),Z(),V(),K()}},F=e=>{if(!e||!e.hasAttribute("data-group"))return;const t=N(e);if(!n[t]||!n[t].triggerElements.includes(e))return;const r=n[t].triggerElements.indexOf(e);if(n[t].triggerElements.splice(r,1),n[t].sliderElements.splice(r,1),e.classList.contains("parvus-zoom")){const t=e.querySelector(".parvus-zoom__indicator");e.classList.remove("parvus-zoom"),e.removeChild(t)}be()&&t===l&&(Z(),V(),K()),e.removeEventListener("click",re),e.classList.remove("parvus-trigger")},X=e=>{if(void 0!==n[l].sliderElements[e])return;const t=document.createElement("div"),r=document.createElement("div"),s=n[l].triggerElements.length;if(t.className="parvus__slide",t.style.position="absolute",t.style.left=100*e+"%",t.setAttribute("aria-hidden","true"),t.appendChild(r),s>1&&(t.setAttribute("role","group"),t.setAttribute("aria-label",`${u.l10n.slideLabel} ${e+1}/${s}`)),n[l].sliderElements[e]=t,e>=d){const r=(e=>{const t=n[l].sliderElements,r=t.length;for(let s=e+1;s<r;s++)if(void 0!==t[s])return s;return-1})(e);-1!==r?n[l].sliderElements[r].before(t):n[l].slider.appendChild(t)}else{const r=(e=>{const t=n[l].sliderElements;for(let r=e-1;r>=0;r--)if(void 0!==t[r])return r;return-1})(e);-1!==r?n[l].sliderElements[r].after(t):n[l].slider.prepend(t)}},Y=e=>{if(!c||!e||!e.classList.contains("parvus-trigger")||be())return;if(l=N(e),!n[l].triggerElements.includes(e))throw new Error("Ups, I can't find the element.");d=n[l].triggerElements.indexOf(e),C=document.activeElement,history.pushState({parvus:"close"},"Image",window.location.href),he();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((e=>{e.setAttribute("aria-hidden","true"),e.classList.add("parvus-hidden")})),u.hideScrollbar&&(document.body.style.marginInlineEnd=r.innerWidth-document.documentElement.clientWidth+"px",document.body.style.overflow="hidden"),c.classList.add("parvus--is-opening"),c.setAttribute("aria-hidden","false"),(()=>{const e=document.createElement("div");e.className="parvus__slider",e.setAttribute("aria-hidden","true"),n[l].slider=e,c.appendChild(e)})(),X(d),n[l].slider.setAttribute("aria-hidden","false"),G(),Z(),V(),K(),ne(),D(d),O(e,d,(()=>{P(d,!0),c.classList.remove("parvus--is-opening"),n[l].slider.classList.add("parvus__slider--animate")})),H(d+1),H(d-1),fe("open",{source:e}),document.body.classList.add("parvus-is-open")},z=()=>{if(!be())throw new Error("Ups, I'm already closed.");const e=n[l].contentElements[d],t=n[l].triggerElements[d];ge(),J(),"close"===history.state?.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((e=>{e.removeAttribute("aria-hidden"),e.classList.remove("parvus-hidden")})),c.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{const r=t.getBoundingClientRect();if(e&&"IMG"===e.tagName){const t=e.getBoundingClientRect(),s=r.width/t.width,i=r.height/t.height,n=r.left-t.left,a=r.top-t.top;e.style.transform=`translate(${n}px, ${a}px) scale(${s}, ${i})`}e.style.opacity=0,e.style.transition=`transform ${T}ms ${u.transitionTimingFunction}, opacity ${T}ms ${u.transitionTimingFunction} ${T/2}ms`}));const r=()=>{W(d),C=u.backFocus?C:n[l].triggerElements[d],C.focus({preventScroll:!0}),c.setAttribute("aria-hidden","true"),c.classList.remove("parvus--is-closing"),c.classList.remove("parvus--is-vertical-closing"),e.style.transform="",e.removeEventListener("transitionend",r),n[l].slider.remove(),n[l].slider=null,n[l].sliderElements=[],n[l].contentElements=[],y.removeAttribute("aria-hidden"),f.removeAttribute("aria-hidden"),f.removeAttribute("aria-disabled"),E.removeAttribute("aria-hidden"),E.removeAttribute("aria-disabled"),u.hideScrollbar&&(document.body.style.marginInlineEnd="",document.body.style.overflow="")};e.addEventListener("transitionend",r,{once:!0}),fe("close",{detail:{source:n[l].triggerElements[d]}}),document.body.classList.remove("parvus-is-open")},H=e=>{e<0||e>=n[l].triggerElements.length||void 0!==n[l].sliderElements[e]||(X(e),O(n[l].triggerElements[e],e,(()=>{P(e)})))},D=e=>{n[l].sliderElements[e].setAttribute("aria-hidden","false")},O=(e,t,r)=>{const{contentElements:s,sliderElements:i}=n[l];if(void 0!==s[t])return void(r&&"function"==typeof r&&r());const a=i[t].querySelector("div"),o=new Image,d=document.createElement("div"),c=e.querySelector("img"),m=document.createElement("div");d.className="parvus__content",m.className="parvus__loader",m.setAttribute("role","progressbar"),m.setAttribute("aria-label",u.l10n.lightboxLoadingIndicatorLabel),a.appendChild(m);new Promise(((e,t)=>{o.onload=()=>e(o),o.onerror=e=>t(e)})).then((r=>{r.style.opacity=0,d.appendChild(r),a.appendChild(d),u.captions&&((e,t,r)=>{const s=document.createElement("div");let i=null;if(s.className="parvus__caption","self"===u.captionsSelector)t.hasAttribute(u.captionsAttribute)&&""!==t.getAttribute(u.captionsAttribute)&&(i=t.getAttribute(u.captionsAttribute));else{const e=t.querySelector(u.captionsSelector);null!==e&&(i=e.hasAttribute(u.captionsAttribute)&&""!==e.getAttribute(u.captionsAttribute)?e.getAttribute(u.captionsAttribute):e.innerHTML)}if(null!==i){const t=`parvus__caption-${r}`;s.setAttribute("aria-labelledby",t),s.id=t,s.innerHTML=`<p>${i}</p>`,e.appendChild(s)}})(a,e,t),s[t]=r,r.setAttribute("width",r.naturalWidth),r.setAttribute("height",r.naturalHeight),te(i[t],r)})).catch((()=>{const e=document.createElement("div");e.classList.add("parvus__content"),e.classList.add("parvus__content--error"),e.innerHTML=`${u.l10n.lightboxLoadingError}`,a.appendChild(e),s[t]=e})).finally((()=>{a.removeChild(m),r&&"function"==typeof r&&r()})),e.hasAttribute("data-sizes")&&""!==e.getAttribute("data-sizes")&&o.setAttribute("sizes",e.getAttribute("data-sizes")),e.hasAttribute("data-srcset")&&""!==e.getAttribute("data-srcset")&&o.setAttribute("srcset",e.getAttribute("data-srcset")),"A"===e.tagName?o.setAttribute("src",e.href):o.setAttribute("src",e.getAttribute("data-target")),c&&c.hasAttribute("alt")&&""!==c.getAttribute("alt")?o.alt=c.alt:e.hasAttribute("data-alt")&&""!==e.getAttribute("data-alt")?o.alt=e.getAttribute("data-alt"):o.alt=""},P=(e,t)=>{const r=n[l].contentElements[e];if(r&&"IMG"===r.tagName){const s=n[l].triggerElements[e];if(t){const e=r.getBoundingClientRect(),t=s.getBoundingClientRect(),i=t.width/e.width,n=t.height/e.height,a=t.left-e.left,o=t.top-e.top;requestAnimationFrame((()=>{r.style.transform=`translate(${a}px, ${o}px) scale(${i}, ${n})`,r.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{r.style.transform="",r.style.opacity=1,r.style.transition=`transform ${T}ms ${u.transitionTimingFunction}, opacity ${T/2}ms ${u.transitionTimingFunction}`}))}))}else r.style.opacity=1}else r.style.opacity=1},R=e=>{const t=d;if(!be())throw new Error("Oops, I'm closed.");{if("number"!=typeof e||isNaN(e))throw new Error("Oops, no slide specified.");const t=n[l].triggerElements;if(e===d)throw new Error(`Oops, slide ${e} is already selected.`);if(e<-1||e>=t.length)throw new Error(`Oops, I can't find slide ${e}.`)}void 0!==n[l].sliderElements[e]||(X(e),O(n[l].triggerElements[e],e,(()=>{P(e)}))),D(e),d=e,G(),e<t?(V(),H(e-1)):e>t&&(V(),H(e+1)),W(t),K(),fe("select",{detail:{source:n[l].triggerElements[d]}})},j=()=>{if(d>0)R(d-1);else{const{slider:e}=n[l],t=k+u.threshold;requestAnimationFrame((()=>{e.style.transform=`translate3d(${t}px, 0, 0)`,setTimeout((()=>{G()}),150)}))}},U=()=>{const{slider:e,triggerElements:t}=n[l];if(d<t.length-1)R(d+1);else{const t=k-u.threshold;requestAnimationFrame((()=>{e.style.transform=`translate3d(${t}px, 0, 0)`,setTimeout((()=>{G()}),150)}))}},W=e=>{void 0!==n[l].sliderElements[e]&&n[l].sliderElements[e].setAttribute("aria-hidden","true")},G=()=>{l=null!==l?l:o,$=-d*c.offsetWidth,n[l].slider.style.transform=`translate3d(${$}px, 0, 0)`,k=$},V=()=>{const{triggerElements:e}=n[l],t=e.length,r=d===t-1;t>1&&(0===d?(f.setAttribute("aria-disabled","true"),E.removeAttribute("aria-disabled")):r?(f.removeAttribute("aria-disabled"),E.setAttribute("aria-disabled","true")):(f.removeAttribute("aria-disabled"),E.removeAttribute("aria-disabled")))},K=()=>{y.textContent=`${d+1}/${n[l].triggerElements.length}`},J=()=>{w={startX:0,endX:0,startY:0,endY:0}},Q=()=>{const{startX:e,startY:t,endX:r,endY:s}=w,i=r-e,a=s-t,o=Math.abs(i),p=Math.abs(a),{triggerElements:h}=n[l],g=h.length;L?i>2&&o>=u.threshold&&d>0?j():i<2&&o>=u.threshold&&d!==g-1?U():G():_?(p>2&&u.swipeClose&&p>=u.threshold?z():(c.classList.remove("parvus--is-vertical-closing"),G()),m.style.opacity=""):G()},Z=()=>{const e=n[l].triggerElements.length,t=n[l].slider,r=n[l].sliderElements,s=u.simulateTouch||ve(),i=t.classList.contains("parvus__slider--is-draggable");s&&u.swipeClose&&!i||s&&e>1&&!i?t.classList.add("parvus__slider--is-draggable"):t.classList.remove("parvus__slider--is-draggable"),e>1?(t.setAttribute("role","region"),t.setAttribute("aria-roledescription","carousel"),t.setAttribute("aria-label",u.l10n.sliderLabel),r.forEach(((t,r)=>{t.setAttribute("role","group"),t.setAttribute("aria-label",`${u.l10n.slideLabel} ${r+1}/${e}`)}))):(t.removeAttribute("role"),t.removeAttribute("aria-roledescription"),t.removeAttribute("aria-label"),r.forEach((e=>{e.removeAttribute("role"),e.removeAttribute("aria-label")}))),1===e?(y.setAttribute("aria-hidden","true"),f.setAttribute("aria-hidden","true"),E.setAttribute("aria-hidden","true")):(y.removeAttribute("aria-hidden"),f.removeAttribute("aria-hidden"),E.removeAttribute("aria-hidden"))},ee=()=>{I||(I=!0,r.requestAnimationFrame((()=>{n[l].sliderElements.forEach(((e,t)=>{te(e,n[l].contentElements[t])})),G(),I=!1})))},te=(e,t)=>{if("IMG"!==t.tagName)return;const r=getComputedStyle(e),s=e.querySelector(".parvus__caption"),i=s?s.getBoundingClientRect().height:0,n=t.getAttribute("height"),a=t.getAttribute("width");let o=e.offsetHeight,l=e.offsetWidth;o-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(i),l-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);const d=Math.min(l/a||0,o/n),u=a*d||0,c=n*d||0;n>c&&n<o&&a>u&&a<l||n<c&&n<o&&a<u&&a<l?(t.style.width="",t.style.height=""):(t.style.width=`${u}px`,t.style.height=`${c}px`)},re=function(e){e.preventDefault(),Y(this)},se=e=>{const{target:t}=e;t===f?j():t===E?U():(t===A||u.docClose&&!_&&!L&&t.classList.contains("parvus__slide"))&&z(),e.stopPropagation()},ie=()=>Array.from(c.querySelectorAll(s.join(", "))).filter((e=>null!==e.offsetParent)),ne=()=>{ie()[0].focus()},ae=e=>{const t=ie(),r=t.indexOf(document.activeElement),s=t.length-1;switch(e.code){case"Tab":e.shiftKey?0===r&&(t[s].focus(),e.preventDefault()):r===s&&(t[0].focus(),e.preventDefault());break;case"Escape":z(),e.preventDefault();break;case"ArrowLeft":j(),e.preventDefault();break;case"ArrowRight":U(),e.preventDefault()}},oe=e=>{L=!1,_=!1,x=!0;const{pageX:t,pageY:r}=e;w.startX=t,w.startY=r;const{slider:s}=n[l];s.classList.add("parvus__slider--is-dragging"),s.style.willChange="transform",e.stopPropagation(),p=getComputedStyle(m).opacity},le=e=>{if(x){const{pageX:t,pageY:r}=e;w.endX=t,w.endY=r,pe()}e.preventDefault()},de=()=>{x=!1;const{slider:e}=n[l];e.classList.remove("parvus__slider--is-dragging"),e.style.willChange="",(w.endX||w.endY)&&Q(),J()},ue=e=>{L=!1,_=!1;const{clientX:t,clientY:r}=e.changedTouches[0];w.startX=parseInt(t),w.startY=parseInt(r);const{slider:s}=n[l];s.classList.add("parvus__slider--is-dragging"),s.style.willChange="transform",p=getComputedStyle(m).getPropertyValue("opacity"),e.stopPropagation()},ce=e=>{const{clientX:t,clientY:r}=e.changedTouches[0];w.endX=parseInt(t),w.endY=parseInt(r),pe(),e.preventDefault()},me=()=>{const{slider:e}=n[l];e.classList.remove("parvus__slider--is-dragging"),e.style.willChange="",(w.endX||w.endY)&&Q(),J()},pe=()=>{const{startX:e,endX:t,startY:r,endY:s}=w,i=e-t,a=s-r,o=Math.abs(a);Math.abs(i)>2&&!_&&n[l].triggerElements.length>1?(n[l].slider.style.transform=`translate3d(${k-Math.round(i)}px, 0, 0)`,L=!0,_=!1):Math.abs(a)>2&&!L&&u.swipeClose&&(!S&&o<=100&&(m.style.opacity=p-o/100),c.classList.add("parvus--is-vertical-closing"),n[l].slider.style.transform=`translate3d(${k}px, ${Math.round(a)}px, 0)`,L=!1,_=!0)},he=()=>{r.addEventListener("keydown",ae),r.addEventListener("resize",ee),r.addEventListener("popstate",z),c.addEventListener("click",se),ve()&&(c.addEventListener("touchstart",ue),c.addEventListener("touchmove",ce),c.addEventListener("touchend",me)),u.simulateTouch&&(c.addEventListener("mousedown",oe),c.addEventListener("mouseup",de),c.addEventListener("mousemove",le))},ge=()=>{r.removeEventListener("keydown",ae),r.removeEventListener("resize",ee),r.removeEventListener("popstate",z),c.removeEventListener("click",se),ve()&&(c.removeEventListener("touchstart",ue),c.removeEventListener("touchmove",ce),c.removeEventListener("touchend",me)),u.simulateTouch&&(c.removeEventListener("mousedown",oe),c.removeEventListener("mouseup",de),c.removeEventListener("mousemove",le))},be=()=>"false"===c.getAttribute("aria-hidden"),ve=()=>"ontouchstart"in window,fe=function(e){const t=new CustomEvent(e,{detail:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},cancelable:!0});c.dispatchEvent(t)},Ee=()=>{if(u=(t=>({selector:".lightbox",gallerySelector:null,captions:!0,captionsSelector:"self",captionsAttribute:"data-caption",docClose:!0,swipeClose:!0,simulateTouch:!0,threshold:50,backFocus:!0,hideScrollbar:!0,transitionDuration:300,transitionTimingFunction:"cubic-bezier(0.62, 0.16, 0.13, 1.01)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12"/></svg>',l10n:e,...t}))(t),!document.querySelectorAll(u.selector).length)return;if(B(),c||(c=document.createElement("div"),c.setAttribute("role","dialog"),c.setAttribute("aria-modal","true"),c.setAttribute("aria-hidden","true"),c.setAttribute("tabindex","-1"),c.setAttribute("aria-label",u.l10n.lightboxLabel),c.classList.add("parvus"),m=document.createElement("div"),m.classList.add("parvus__overlay"),c.appendChild(m),h=document.createElement("div"),h.className="parvus__toolbar",g=document.createElement("div"),b=document.createElement("div"),v=document.createElement("div"),v.className="parvus__controls",v.setAttribute("role","group"),v.setAttribute("aria-label",u.l10n.controlsLabel),b.appendChild(v),A=document.createElement("button"),A.className="parvus__btn parvus__btn--close",A.setAttribute("type","button"),A.setAttribute("aria-label",u.l10n.closeButtonLabel),A.innerHTML=u.closeButtonIcon,v.appendChild(A),f=document.createElement("button"),f.className="parvus__btn parvus__btn--previous",f.setAttribute("type","button"),f.setAttribute("aria-label",u.l10n.previousButtonLabel),f.innerHTML=u.previousButtonIcon,v.appendChild(f),E=document.createElement("button"),E.className="parvus__btn parvus__btn--next",E.setAttribute("type","button"),E.setAttribute("aria-label",u.l10n.nextButtonLabel),E.innerHTML=u.nextButtonIcon,v.appendChild(E),y=document.createElement("div"),y.className="parvus__counter",g.appendChild(y),h.appendChild(g),h.appendChild(b),c.appendChild(h),document.body.appendChild(c)),null!==u.gallerySelector){document.querySelectorAll(u.gallerySelector).forEach(((e,t)=>{const r=t;e.querySelectorAll(u.selector).forEach((e=>{e.setAttribute("data-group",`parvus-gallery-${r}`),q(e)}))}))}document.querySelectorAll(`${u.selector}:not(.parvus-trigger)`).forEach(q)};return Ee(),{init:Ee,open:Y,close:z,select:R,previous:j,next:U,currentIndex:()=>d,add:q,remove:F,destroy:()=>{if(!c)return;be()&&z(),c.remove();document.querySelectorAll(".parvus-trigger").forEach(F),fe("destroy")},isOpen:be,on:(e,t)=>{c&&c.addEventListener(e,t)},off:(e,t)=>{c&&c.removeEventListener(e,t)}}}}));

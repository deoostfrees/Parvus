/**
 * Parvus
 *
 * @author de Oostfreese
 * @version 1.3.0
 * @url https://github.com/deoostfreese/parvus
 *
 * MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Parvus=t()}(this,(function(){"use strict";return function e(t){const n=window,s=["button:not([disabled]):not([inert])",'[tabindex]:not([tabindex^="-"]):not([inert])'],i={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},r={};let a,o,l,d,u=null,c=null,p={},h=null,m=null,g=0,v=null,f=null,b=null,y={},L=!1,x=!1,E=!1,w=null,A=null,_=null,I=null,C=!0;const $=window.matchMedia("(prefers-reduced-motion)"),T=function(){$.matches?(C=!0,I=p.reducedTransitionDuration):(C=!1,I=p.transitionDuration)};$.addEventListener("change",T);const B=function(e){p=function(e){return{selector:".lightbox",docClose:!0,scrollClose:!1,swipeClose:!0,threshold:100,backFocus:!0,transitionDuration:300,reducedTransitionDuration:.1,transitionTimingFunction:"cubic-bezier(0.2, 0, 0.2, 1)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M18 6L6 18M6 6l12 12"/></svg>',lang:"en",i18n:{en:{lightboxLabel:"This is a dialog window which overlays the main content of the page. The modal shows the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window"}},fileTypes:/\.(png|jpe?g|webp|avif|svg)(\?.*)?$/i,...e}}(e),T(),h||Y();document.querySelectorAll(p.selector).forEach((e=>{N(e)}))},M=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},N=function(e){var t;if("A"===e.tagName&&e.hasAttribute("href")&&e.href.match(p.fileTypes)||"BUTTON"===e.tagName&&e.hasAttribute("data-target")&&e.getAttribute("data-target").match(p.fileTypes))if(u=M(e),Object.prototype.hasOwnProperty.call(r,u)||(r[u]=(t=i,JSON.parse(JSON.stringify(t))),k()),-1===r[u].gallery.indexOf(e)){if(r[u].gallery.push(e),r[u].elementsLength++,null!==e.querySelector("img")){e.classList.add("parvus-zoom");const t=document.createElement("div");t.className="parvus-zoom__indicator",t.innerHTML=p.lightboxIndicatorIcon,e.appendChild(t)}e.classList.add("parvus-trigger"),e.addEventListener("click",V),D(e),pe()&&u===c&&G()}else console.log("Ups, element already added.");else console.log(e,`Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file. Supported image file types: ${p.fileTypes}.`)},X=function(e){e.classList.contains("parvus-zoom")&&(e.classList.remove("parvus-zoom"),e.removeEventListener("click",V))},Y=function(){h=document.createElement("div"),h.setAttribute("role","dialog"),h.setAttribute("aria-modal","true"),h.setAttribute("aria-hidden","true"),h.setAttribute("tabindex","-1"),h.setAttribute("aria-label",p.i18n[p.lang].lightboxLabel),h.classList.add("parvus"),m=document.createElement("div"),m.classList.add("parvus__overlay"),m.style.opacity=0,h.appendChild(m),b=document.createElement("button"),b.className="parvus__btn parvus__btn--close",b.setAttribute("type","button"),b.setAttribute("aria-label",p.i18n[p.lang].closeButtonLabel),b.innerHTML=p.closeButtonIcon,h.appendChild(b),v=document.createElement("button"),v.className="parvus__btn parvus__btn--previous",v.setAttribute("type","button"),v.setAttribute("aria-label",p.i18n[p.lang].previousButtonLabel),v.innerHTML=p.previousButtonIcon,h.appendChild(v),f=document.createElement("button"),f.className="parvus__btn parvus__btn--next",f.setAttribute("type","button"),f.setAttribute("aria-label",p.i18n[p.lang].nextButtonLabel),f.innerHTML=p.nextButtonIcon,h.appendChild(f),document.body.appendChild(h)},k=function(){r[u].slider=document.createElement("div"),r[u].slider.className="parvus__slider",r[u].slider.setAttribute("aria-hidden","true"),h.appendChild(r[u].slider)},D=function(e){const t=document.createElement("div"),n=document.createElement("div");t.className="parvus__slide",t.style.position="absolute",t.style.left=100*r[u].x+"%",t.setAttribute("aria-hidden","true"),H(e,n),t.appendChild(n),r[u].slider.appendChild(t),r[u].sliderElements.push(t),++r[u].x},S=function(e){if(pe())throw new Error("Ups, I'm aleady open.");G(),w=document.activeElement;const t=window.location.href;history.pushState({parvus:"close"},"Image",t),r[c].currentIndex=e,ue();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((e=>{e.setAttribute("aria-hidden","true"),e.classList.add("parvus-hidden")})),h.classList.add("parvus--is-opening"),h.setAttribute("aria-hidden","false"),ee(),requestAnimationFrame((()=>{h.classList.remove("parvus--is-opening"),m.style.opacity=1,m.style.transition=`opacity ${I}ms ${p.transitionTimingFunction}`})),r[c].slider.setAttribute("aria-hidden","false"),O(r[c].currentIndex),W(),z(r[c].currentIndex,!0),F(r[c].currentIndex+1),F(r[c].currentIndex-1),setTimeout((()=>{r[c].slider.classList.add("parvus__slider--animate")}),1e3);const n=new CustomEvent("open");h.dispatchEvent(n)},q=function(){if(!pe())throw new Error("Ups, I'm already closed.");const e=r[c].sliderElements[r[c].currentIndex].querySelector("img"),t=r[c].gallery[r[c].currentIndex].getBoundingClientRect(),n=e.getBoundingClientRect();ce(),J(),null!==history.state&&"close"===history.state.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((e=>{e.removeAttribute("aria-hidden"),e.classList.remove("parvus-hidden")})),h.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{p.backFocus&&(a=t.width/n.width,o=t.height/n.height,l=t.left-n.left,d=t.top-n.top),e.style.transform=`translate(${l}px, ${d}px) scale(${a}, ${o})`,e.style.transition=`transform ${I}ms ${p.transitionTimingFunction}`,m.style.opacity=.1,m.style.transition=`opacity ${I}ms ${p.transitionTimingFunction} ${I}ms`})),m.addEventListener("transitionend",(()=>{j(r[c].currentIndex),w=p.backFocus?r[c].gallery[r[c].currentIndex]:w,w.focus({preventScroll:!0}),r[c].slider.setAttribute("aria-hidden","true"),h.setAttribute("aria-hidden","true"),h.classList.remove("parvus--is-closing"),h.classList.remove("parvus--is-vertical-closing"),r[c].slider.classList.remove("parvus__slider--animate"),e.style.transform=""}),{once:!0});const s=new CustomEvent("close");h.dispatchEvent(s)},F=function(e){void 0!==r[c].sliderElements[e]&&z(e)},O=function(e){void 0!==r[c].sliderElements[e]&&(r[c].sliderElements[e].classList.add("parvus__slide--is-active"),r[c].sliderElements[e].setAttribute("aria-hidden","false"))},H=function(e,t){const n=document.createElement("img"),s=document.createElement("figure"),i=document.createElement("figurecaption"),r=e.querySelector("img");"A"===e.tagName?(n.setAttribute("data-src",e.href),n.alt=r?r.alt||"":e.getAttribute("data-alt")||""):(n.alt=e.getAttribute("data-alt")||"",n.setAttribute("data-src",e.getAttribute("data-target"))),n.style.opacity=0,s.appendChild(n),e.hasAttribute("data-caption")&&""!==e.getAttribute("data-caption")&&(i.innerHTML=e.getAttribute("data-caption"),s.appendChild(i)),t.appendChild(s)},P=function(e){const t=r[c].sliderElements[e].querySelector("img"),n=r[c].gallery[e].getBoundingClientRect(),s=t.getBoundingClientRect();console.log("Thumb: ",n),console.log("Image: ",s),a=n.width/s.width,o=n.height/s.height,l=n.left-s.left,d=n.top-s.top,requestAnimationFrame((()=>{console.log(`translate(${l}px, ${d}px) scale(${a}, ${o})`),t.style.transform=`translate(${l}px, ${d}px) scale(${a}, ${o})`,t.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{t.style.transform="",t.style.opacity=1,t.style.transition=`transform ${I}ms ${p.transitionTimingFunction}, opacity ${I}ms ${p.transitionTimingFunction}`}))}))},z=function(e,t){const n=r[c].sliderElements[e],s=n.querySelector("img"),i=document.createElement("div");s.hasAttribute("data-src")?(i.className="parvus__loader",i.setAttribute("role","progressbar"),i.setAttribute("aria-label",p.i18n[p.lang].lightboxLOADING_INDICATORLabel),n.appendChild(i),s.onload=()=>{s.setAttribute("width",s.naturalWidth),s.setAttribute("height",s.naturalHeight),n.removeChild(i),P(e)},s.setAttribute("src",s.getAttribute("data-src")),s.removeAttribute("data-src")):t&&(console.log("yeah!"),P(e))},R=function(){pe()&&r[c].currentIndex>0&&(j(r[c].currentIndex),--r[c].currentIndex,O(r[c].currentIndex),z(r[c].currentIndex),W(),F(r[c].currentIndex-1))},U=function(){pe()&&r[c].currentIndex<r[c].elementsLength-1&&(j(r[c].currentIndex),++r[c].currentIndex,O(r[c].currentIndex),z(r[c].currentIndex),W(),F(r[c].currentIndex+1))},j=function(e){void 0!==r[c].sliderElements[e]&&(r[c].sliderElements[e].classList.remove("parvus__slide--is-active"),r[c].sliderElements[e].setAttribute("aria-hidden","true"))},W=function(){c=null!==c?c:u,A=-r[c].currentIndex*h.offsetWidth,r[c].slider.style.transform=`translate3d(${A}px, 0, 0)`,_=A},J=function(){y={startX:0,endX:0,startY:0,endY:0}},K=function(){const e=y.endX-y.startX,t=y.endY-y.startY,n=Math.abs(e),s=Math.abs(t);L&&e>0&&n>=p.threshold&&r[c].currentIndex>0?R():L&&e<0&&n>=p.threshold&&r[c].currentIndex!==r[c].elementsLength-1?U():x&&s>0?s>=p.threshold&&p.swipeClose?q():(m.style.opacity=1,h.classList.remove("parvus--is-vertical-closing"),W()):W()},G=function(){(p.swipeClose&&!r[c].slider.classList.contains("parvus__slider--is-draggable")||r[c].elementsLength>1&&!r[c].slider.classList.contains("parvus__slider--is-draggable"))&&r[c].slider.classList.add("parvus__slider--is-draggable"),1===r[c].elementsLength?(v.setAttribute("aria-hidden","true"),v.disabled=!0,f.setAttribute("aria-hidden","true"),f.disabled=!0):(v.setAttribute("aria-hidden","false"),v.disabled=!1,f.setAttribute("aria-hidden","false"),f.disabled=!1)},V=function(e){e.preventDefault(),c=M(this),S(r[c].gallery.indexOf(this))},Q=function(e){e.target===v?R():e.target===f?U():(e.target===b||!x&&!L&&e.target.classList.contains("parvus__slide")&&p.docClose)&&q(),e.stopPropagation()},Z=function(){return Array.prototype.slice.call(h.querySelectorAll(`${s.join(", ")}`)).filter((function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}))},ee=function(){Z()[0].focus()},te=function(e){const t=Z(),n=t.indexOf(document.activeElement);"Tab"===e.code?e.shiftKey&&0===n?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||n!==t.length-1||(t[0].focus(),e.preventDefault()):"Escape"===e.code?(e.preventDefault(),q()):"ArrowLeft"===e.code?(e.preventDefault(),R()):"ArrowRight"===e.code&&(e.preventDefault(),U())},ne=function(){q()},se=function(e){e.preventDefault(),e.stopPropagation(),L=!1,x=!1,E=!0,y.startX=e.pageX,y.startY=e.pageY,r[c].slider.classList.add("parvus__slider--is-dragging")},ie=function(e){e.preventDefault(),E&&(y.endX=e.pageX,y.endY=e.pageY,de())},re=function(e){e.stopPropagation(),E=!1,r[c].slider.classList.remove("parvus__slider--is-dragging"),(y.endX||y.endY)&&K(),J()},ae=function(e){e.stopPropagation(),L=!1,x=!1,E=!0,y.startX=e.touches[0].pageX,y.startY=e.touches[0].pageY,r[c].slider.classList.add("parvus__slider--is-dragging")},oe=function(e){e.stopPropagation(),E&&(e.preventDefault(),y.endX=e.touches[0].pageX,y.endY=e.touches[0].pageY,de())},le=function(e){e.stopPropagation(),E=!1,r[c].slider.classList.remove("parvus__slider--is-dragging"),(y.endX||y.endY)&&K(),J()},de=function(){const e=y.startX-y.endX,t=y.endY-y.startY,n=Math.abs(t);Math.abs(e)>0&&!x&&r[c].elementsLength>1&&!C?(r[c].slider.style.transform=`translate3d(${_-Math.round(e)}px, 0, 0)`,L=!0,x=!1):Math.abs(t)>0&&!L&&p.swipeClose&&!C&&(n<=100&&(g=1-n/100),h.classList.add("parvus--is-vertical-closing"),m.style.opacity=g,r[c].slider.style.transform=`translate3d(${_}px, ${Math.round(t)}px, 0)`,L=!1,x=!0)},ue=function(){n.addEventListener("keydown",te),p.scrollClose&&n.addEventListener("wheel",ne),n.addEventListener("popstate",q),h.addEventListener("click",Q),he()&&(h.addEventListener("touchstart",ae),h.addEventListener("touchmove",oe),h.addEventListener("touchend",le)),h.addEventListener("mousedown",se),h.addEventListener("mouseup",re),h.addEventListener("mousemove",ie)},ce=function(){n.removeEventListener("keydown",te),p.scrollClose&&n.removeEventListener("wheel",ne),n.removeEventListener("popstate",q),h.removeEventListener("click",Q),he()&&(h.removeEventListener("touchstart",ae),h.removeEventListener("touchmove",oe),h.removeEventListener("touchend",le)),h.removeEventListener("mousedown",se),h.removeEventListener("mouseup",re),h.removeEventListener("mousemove",ie)},pe=function(){return"false"===h.getAttribute("aria-hidden")},he=function(){return"ontouchstart"in window};return B(t),e.init=B,e.open=S,e.close=q,e.previous=R,e.next=U,e.add=N,e.remove=X,e.destroy=function(){pe()&&q();document.querySelectorAll(".parvus-zoom").forEach((e=>{X(e)}));const e=new CustomEvent("destroy");h.dispatchEvent(e)},e.isOpen=pe,e.on=function(e,t){h.addEventListener(e,t)},e.off=function(e,t){h.removeEventListener(e,t)},e}}));

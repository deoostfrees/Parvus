/**
 * Parvus
 *
 * @author de Oostfreese
 * @version 1.3.0
 * @url https://github.com/deoostfreese/parvus
 *
 * MIT license
 */
function e(t){const n=window,r=["button:not([disabled]):not([inert])",'[tabindex]:not([tabindex^="-"]):not([inert])'],s={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},i={};let a,o,l,d,u=null,c=null,p={},h=null,m=null,g=0,v=null,f=null,b=null,y={},L=!1,E=!1,w=!1,x=null,A=null,_=null,I=null,C=!0;const $=window.matchMedia("(prefers-reduced-motion)"),T=function(){$.matches?(C=!0,I=p.reducedTransitionDuration):(C=!1,I=p.transitionDuration)};$.addEventListener("change",T);const B=function(e){if(p=function(e){return{selector:".lightbox",gallerySelector:null,docClose:!0,scrollClose:!1,swipeClose:!0,threshold:100,backFocus:!0,transitionDuration:300,reducedTransitionDuration:.1,transitionTimingFunction:"cubic-bezier(0.2, 0, 0.2, 1)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M18 6L6 18M6 6l12 12"/></svg>',lang:"en",i18n:{en:{lightboxLabel:"This is a dialog window which overlays the main content of the page. The modal shows the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window"}},fileTypes:/\.(png|jpe?g|webp|avif|svg)(\?.*)?$/i,...e}}(e),T(),h||X(),null!==p.gallerySelector){document.querySelectorAll(p.gallerySelector).forEach(((e,t)=>{const n=t;e.querySelectorAll(p.selector).forEach((e=>{e.setAttribute("data-group",`parvus-gallery-${n}`),M(e)}))}));document.querySelectorAll(`${p.selector}:not(.parvus-trigger)`).forEach((e=>{M(e)}))}else{document.querySelectorAll(p.selector).forEach((e=>{M(e)}))}},S=function(e){return e.hasAttribute("data-group")?e.getAttribute("data-group"):"default"},M=function(e){var t;if("A"===e.tagName&&e.hasAttribute("href")&&e.href.match(p.fileTypes)||"BUTTON"===e.tagName&&e.hasAttribute("data-target")&&e.getAttribute("data-target").match(p.fileTypes))if(u=S(e),Object.prototype.hasOwnProperty.call(i,u)||(i[u]=(t=s,JSON.parse(JSON.stringify(t))),Y()),-1===i[u].gallery.indexOf(e)){if(i[u].gallery.push(e),i[u].elementsLength++,null!==e.querySelector("img")){const t=document.createElement("div");e.classList.add("parvus-zoom"),t.className="parvus-zoom__indicator",t.innerHTML=p.lightboxIndicatorIcon,e.appendChild(t)}e.classList.add("parvus-trigger"),e.addEventListener("click",G),k(e),pe()&&u===c&&V()}else console.log("Ups, element already added.");else console.log(e,`Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file. Supported image file types: ${p.fileTypes}.`)},q=function(e){const t=S(e);if(-1===i[t].gallery.indexOf(e))throw new Error(`Ups, I can't find a slide for the element ${e}.`);{const n=i[t].gallery.indexOf(e);if(pe()&&t===c&&n===i[t].currentIndex){if(1===i[t].elementsLength)throw D(),new Error("Ups, I've closed. There are no slides more to show.");0===i[t].currentIndex?R():U()}if(i[t].elementsLength--,e.classList.contains("parvus-zoom")){const t=e.querySelector(".parvus-zoom__indicator");e.classList.remove("parvus-zoom"),e.removeChild(t)}e.removeEventListener("click",G),e.classList.remove("parvus-trigger"),i[t].slider.removeChild(i[t].sliderElements[n])}},X=function(){h=document.createElement("div"),h.setAttribute("role","dialog"),h.setAttribute("aria-modal","true"),h.setAttribute("aria-hidden","true"),h.setAttribute("tabindex","-1"),h.setAttribute("aria-label",p.i18n[p.lang].lightboxLabel),h.classList.add("parvus"),m=document.createElement("div"),m.classList.add("parvus__overlay"),m.style.opacity=0,h.appendChild(m),b=document.createElement("button"),b.className="parvus__btn parvus__btn--close",b.setAttribute("type","button"),b.setAttribute("aria-label",p.i18n[p.lang].closeButtonLabel),b.innerHTML=p.closeButtonIcon,h.appendChild(b),v=document.createElement("button"),v.className="parvus__btn parvus__btn--previous",v.setAttribute("type","button"),v.setAttribute("aria-label",p.i18n[p.lang].previousButtonLabel),v.innerHTML=p.previousButtonIcon,h.appendChild(v),f=document.createElement("button"),f.className="parvus__btn parvus__btn--next",f.setAttribute("type","button"),f.setAttribute("aria-label",p.i18n[p.lang].nextButtonLabel),f.innerHTML=p.nextButtonIcon,h.appendChild(f),document.body.appendChild(h)},Y=function(){i[u].slider=document.createElement("div"),i[u].slider.className="parvus__slider",i[u].slider.setAttribute("aria-hidden","true"),h.appendChild(i[u].slider)},k=function(e){const t=document.createElement("div"),n=document.createElement("div");t.className="parvus__slide",t.style.position="absolute",t.style.left=100*i[u].x+"%",t.setAttribute("aria-hidden","true"),H(e,n),t.appendChild(n),i[u].slider.appendChild(t),i[u].sliderElements.push(t),++i[u].x},N=function(e){if(pe())throw new Error("Ups, I'm aleady open.");V(),x=document.activeElement;const t=window.location.href;history.pushState({parvus:"close"},"Image",t),ue();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((e=>{e.setAttribute("aria-hidden","true"),e.classList.add("parvus-hidden")})),h.classList.add("parvus--is-opening"),h.setAttribute("aria-hidden","false"),ee(),requestAnimationFrame((()=>{h.classList.remove("parvus--is-opening"),m.style.opacity=1,m.style.transition=`opacity ${I}ms ${p.transitionTimingFunction}`})),i[c].slider.setAttribute("aria-hidden","false"),O(e),W(),setTimeout((()=>{i[c].slider.classList.add("parvus__slider--animate")}),I),P(e,!0),F(e+1),F(e-1);const n=new CustomEvent("open");h.dispatchEvent(n)},D=function(){if(!pe())throw new Error("Ups, I'm already closed.");const e=i[c].sliderElements[i[c].currentIndex].querySelector("img"),t=e.getBoundingClientRect(),n=(p.backFocus?i[c].gallery[i[c].currentIndex]:x).getBoundingClientRect();ce(),null!==history.state&&"close"===history.state.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((e=>{e.removeAttribute("aria-hidden"),e.classList.remove("parvus-hidden")})),h.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{a=n.width/t.width,o=n.height/t.height,l=n.left-t.left,d=n.top-t.top,e.style.transform=`translate(${l}px, ${d}px) scale(${a}, ${o})`,e.style.transition=`transform ${I}ms ${p.transitionTimingFunction}`,m.style.opacity=.1,m.style.transition=`opacity ${I}ms ${p.transitionTimingFunction} ${I}ms`})),m.addEventListener("transitionend",(()=>{J(),j(i[c].currentIndex),x=p.backFocus?i[c].gallery[i[c].currentIndex]:x,x.focus({preventScroll:!0}),i[c].slider.setAttribute("aria-hidden","true"),h.setAttribute("aria-hidden","true"),h.classList.remove("parvus--is-closing"),h.classList.remove("parvus--is-vertical-closing"),i[c].slider.classList.remove("parvus__slider--animate"),e.style.transform=""}),{once:!0});const r=new CustomEvent("close");h.dispatchEvent(r)},F=function(e){void 0!==i[c].sliderElements[e]&&P(e)},O=function(e){void 0!==i[c].sliderElements[e]&&(i[c].sliderElements[e].classList.add("parvus__slide--is-active"),i[c].sliderElements[e].setAttribute("aria-hidden","false"))},H=function(e,t){const n=document.createElement("img"),r=document.createElement("figure"),s=document.createElement("figurecaption"),i=e.querySelector("img");"A"===e.tagName?(n.setAttribute("data-src",e.href),n.alt=i?i.alt||"":e.getAttribute("data-alt")||""):(n.alt=e.getAttribute("data-alt")||"",n.setAttribute("data-src",e.getAttribute("data-target"))),n.style.opacity=0,r.appendChild(n),e.hasAttribute("data-caption")&&""!==e.getAttribute("data-caption")&&(s.innerHTML=e.getAttribute("data-caption"),r.appendChild(s)),t.appendChild(r)},z=function(e){const t=i[c].sliderElements[e].querySelector("img"),n=t.getBoundingClientRect(),r=i[c].gallery[e].getBoundingClientRect();a=r.width/n.width,o=r.height/n.height,l=r.left-n.left,d=r.top-n.top,requestAnimationFrame((()=>{t.style.transform=`translate(${l}px, ${d}px) scale(${a}, ${o})`,t.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{t.style.transform="",t.style.opacity=1,t.style.transition=`transform ${I}ms ${p.transitionTimingFunction}, opacity ${I}ms ${p.transitionTimingFunction}`}))}))},P=function(e,t){const n=i[c].sliderElements[e],r=n.querySelector("img"),s=document.createElement("div");r.hasAttribute("data-src")?(s.className="parvus__loader",s.setAttribute("role","progressbar"),s.setAttribute("aria-label",p.i18n[p.lang].lightboxLoadingIndicatorLabel),n.appendChild(s),r.onload=()=>{n.removeChild(s),r.setAttribute("width",r.naturalWidth),r.setAttribute("height",r.naturalHeight),z(e)},r.setAttribute("src",r.getAttribute("data-src")),r.removeAttribute("data-src")):t&&z(e)},U=function(){pe()&&i[c].currentIndex>0&&(j(i[c].currentIndex),--i[c].currentIndex,O(i[c].currentIndex),P(i[c].currentIndex),W(),F(i[c].currentIndex-1))},R=function(){pe()&&i[c].currentIndex<i[c].elementsLength-1&&(j(i[c].currentIndex),++i[c].currentIndex,O(i[c].currentIndex),P(i[c].currentIndex),W(),F(i[c].currentIndex+1))},j=function(e){void 0!==i[c].sliderElements[e]&&(i[c].sliderElements[e].classList.remove("parvus__slide--is-active"),i[c].sliderElements[e].setAttribute("aria-hidden","true"))},W=function(){c=null!==c?c:u,A=-i[c].currentIndex*h.offsetWidth,i[c].slider.style.transform=`translate3d(${A}px, 0, 0)`,_=A},J=function(){y={startX:0,endX:0,startY:0,endY:0}},K=function(){const e=y.endX-y.startX,t=y.endY-y.startY,n=Math.abs(e),r=Math.abs(t);L&&e>0&&n>=p.threshold&&i[c].currentIndex>0?U():L&&e<0&&n>=p.threshold&&i[c].currentIndex!==i[c].elementsLength-1?R():E&&r>0?r>=p.threshold&&p.swipeClose?D():(m.style.opacity=1,h.classList.remove("parvus--is-vertical-closing"),W()):W()},V=function(){(p.swipeClose&&!i[c].slider.classList.contains("parvus__slider--is-draggable")||i[c].elementsLength>1&&!i[c].slider.classList.contains("parvus__slider--is-draggable"))&&i[c].slider.classList.add("parvus__slider--is-draggable"),1===i[c].elementsLength?(v.setAttribute("aria-hidden","true"),v.disabled=!0,f.setAttribute("aria-hidden","true"),f.disabled=!0):(v.setAttribute("aria-hidden","false"),v.disabled=!1,f.setAttribute("aria-hidden","false"),f.disabled=!1)},G=function(e){e.preventDefault(),c=S(this),i[c].currentIndex=i[c].gallery.indexOf(this),N(i[c].currentIndex)},Q=function(e){e.target===v?U():e.target===f?R():(e.target===b||!E&&!L&&e.target.classList.contains("parvus__slide")&&p.docClose)&&D(),e.stopPropagation()},Z=function(){return Array.prototype.slice.call(h.querySelectorAll(`${r.join(", ")}`)).filter((function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}))},ee=function(){Z()[0].focus()},te=function(e){const t=Z(),n=t.indexOf(document.activeElement);"Tab"===e.code?e.shiftKey&&0===n?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||n!==t.length-1||(t[0].focus(),e.preventDefault()):"Escape"===e.code?(e.preventDefault(),D()):"ArrowLeft"===e.code?(e.preventDefault(),U()):"ArrowRight"===e.code&&(e.preventDefault(),R())},ne=function(){D()},re=function(e){e.preventDefault(),e.stopPropagation(),L=!1,E=!1,w=!0,y.startX=e.pageX,y.startY=e.pageY,i[c].slider.classList.add("parvus__slider--is-dragging")},se=function(e){e.preventDefault(),w&&(y.endX=e.pageX,y.endY=e.pageY,de())},ie=function(e){e.stopPropagation(),w=!1,i[c].slider.classList.remove("parvus__slider--is-dragging"),(y.endX||y.endY)&&K(),J()},ae=function(e){e.stopPropagation(),L=!1,E=!1,w=!0,y.startX=e.touches[0].pageX,y.startY=e.touches[0].pageY,i[c].slider.classList.add("parvus__slider--is-dragging")},oe=function(e){e.stopPropagation(),w&&(e.preventDefault(),y.endX=e.touches[0].pageX,y.endY=e.touches[0].pageY,de())},le=function(e){e.stopPropagation(),w=!1,i[c].slider.classList.remove("parvus__slider--is-dragging"),(y.endX||y.endY)&&K(),J()},de=function(){const e=y.startX-y.endX,t=y.endY-y.startY,n=Math.abs(t);Math.abs(e)>0&&!E&&i[c].elementsLength>1&&!C?(i[c].slider.style.transform=`translate3d(${_-Math.round(e)}px, 0, 0)`,L=!0,E=!1):Math.abs(t)>0&&!L&&p.swipeClose&&!C&&(n<=100&&(g=1-n/100),h.classList.add("parvus--is-vertical-closing"),m.style.opacity=g,i[c].slider.style.transform=`translate3d(${_}px, ${Math.round(t)}px, 0)`,L=!1,E=!0)},ue=function(){n.addEventListener("keydown",te),p.scrollClose&&n.addEventListener("wheel",ne),n.addEventListener("popstate",D),h.addEventListener("click",Q),he()&&(h.addEventListener("touchstart",ae),h.addEventListener("touchmove",oe),h.addEventListener("touchend",le)),h.addEventListener("mousedown",re),h.addEventListener("mouseup",ie),h.addEventListener("mousemove",se)},ce=function(){n.removeEventListener("keydown",te),p.scrollClose&&n.removeEventListener("wheel",ne),n.removeEventListener("popstate",D),h.removeEventListener("click",Q),he()&&(h.removeEventListener("touchstart",ae),h.removeEventListener("touchmove",oe),h.removeEventListener("touchend",le)),h.removeEventListener("mousedown",re),h.removeEventListener("mouseup",ie),h.removeEventListener("mousemove",se)},pe=function(){return"false"===h.getAttribute("aria-hidden")},he=function(){return"ontouchstart"in window};return B(t),e.init=B,e.open=N,e.close=D,e.previous=U,e.next=R,e.add=M,e.remove=q,e.destroy=function(){pe()&&D();document.querySelectorAll(".parvus-zoom").forEach((e=>{q(e)}));const e=new CustomEvent("destroy");h.dispatchEvent(e)},e.isOpen=pe,e.on=function(e,t){h.addEventListener(e,t)},e.off=function(e,t){h.removeEventListener(e,t)},e}export default e;

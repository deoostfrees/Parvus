/**
 * Parvus
 *
 * @author Benjamin de Oostfrees
 * @version 2.2.1
 * @url https://github.com/deoostfrees/parvus
 *
 * MIT license
 */

var e={lightboxLabel:"This is a dialog window which overlays the main content of the page. The modal shows the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window"};function t(s){const a=window,r=['a:not([inert]):not([tabindex^="-"])','button:not([inert]):not([tabindex^="-"]):not(:disabled)','[tabindex]:not([inert]):not([tabindex^="-"])'],i={gallery:[],slider:null,sliderElements:[],images:[]},n={};let l=null,o=null,d=0,u={},c=null,p=null,g=1,h=null,m=null,v=null,b=null,y=null,f=null,A=null,E=null,w=0,L=0,_=0,C=0,x={},$=!1,S=!1,T=!1,B=null,I=null,M=null,q=!1,F=null,N=!0;const X=window.matchMedia("(prefers-reduced-motion)"),Y=()=>{X.matches?(N=!0,F=u.reducedTransitionDuration):(N=!1,F=u.transitionDuration)};X.addEventListener("change",Y);const k=t=>{u=(t=>({selector:".lightbox",gallerySelector:null,captions:!0,captionsSelector:"self",captionsAttribute:"data-caption",docClose:!0,scrollClose:!1,swipeClose:!0,simulateTouch:!0,threshold:50,backFocus:!0,transitionDuration:300,reducedTransitionDuration:.1,transitionTimingFunction:"cubic-bezier(0.4, 0, 0.22, 1)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M18 6L6 18M6 6l12 12"/></svg>',l10n:e,fileTypes:/\.(png|jpe?g|webp|avif|svg)(\?.*)?$/i,...t}))(t);if(document.querySelectorAll(u.selector).length)if(Y(),c||z(),null!==u.gallerySelector){document.querySelectorAll(u.gallerySelector).forEach(((e,t)=>{const s=t;e.querySelectorAll(u.selector).forEach((e=>{e.setAttribute("data-group",`parvus-gallery-${s}`),O(e)}))}));document.querySelectorAll(`${u.selector}:not(.parvus-trigger)`).forEach((e=>{O(e)}))}else{document.querySelectorAll(u.selector).forEach((e=>{O(e)}))}},D=e=>{const t=Math.floor(1e4*Math.random());return e.hasAttribute("data-group")&&""!==e.getAttribute("data-group")||e.setAttribute("data-group",`default-${t}`),e.getAttribute("data-group")},O=e=>{if(!("A"===e.tagName&&e.hasAttribute("href")&&e.href.match(u.fileTypes)||"BUTTON"===e.tagName&&e.hasAttribute("data-target")&&e.getAttribute("data-target").match(u.fileTypes)))throw new Error(e,`Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file. Supported image file types: ${u.fileTypes}.`);var t;if(l=D(e),Object.prototype.hasOwnProperty.call(n,l)||(n[l]=(t=i,JSON.parse(JSON.stringify(t)))),n[l].gallery.includes(e))throw new Error("Ups, element already added.");if(n[l].gallery.push(e),null!==e.querySelector("img")){const t=document.createElement("div");e.classList.add("parvus-zoom"),t.className="parvus-zoom__indicator",t.innerHTML=u.lightboxIndicatorIcon,e.appendChild(t)}e.classList.add("parvus-trigger"),e.addEventListener("click",oe),Le()&&l===o&&(R(n[l].gallery.indexOf(e)),J(e,n[l].gallery.indexOf(e),(()=>{K(n[l].gallery.indexOf(e))})),ie(),te(),se())},H=e=>{if(Le()||!c||!e||!e.hasAttribute("data-group"))return;const t=D(e);if(!n[t].gallery.includes(e))throw new Error("Ups, I can't find the element.");if(n[t].gallery.splice(n[t].gallery.indexOf(e),1),n[t].sliderElements.splice(n[t].gallery.indexOf(e),1),e.classList.contains("parvus-zoom")){const t=e.querySelector(".parvus-zoom__indicator");e.classList.remove("parvus-zoom"),e.removeChild(t)}Le()&&t===o&&(ie(),te(),se()),e.removeEventListener("click",oe),e.classList.remove("parvus-trigger")},z=()=>{c=document.createElement("div"),c.setAttribute("role","dialog"),c.setAttribute("aria-modal","true"),c.setAttribute("aria-hidden","true"),c.setAttribute("tabindex","-1"),c.setAttribute("aria-label",u.l10n.lightboxLabel),c.classList.add("parvus"),p=document.createElement("div"),p.classList.add("parvus__overlay"),p.style.opacity=0,c.appendChild(p),h=document.createElement("div"),h.className="parvus__toolbar",m=document.createElement("div"),v=document.createElement("div"),b=document.createElement("div"),b.className="parvus__controls",b.setAttribute("role","group"),b.setAttribute("aria-label","Slide controls"),v.appendChild(b),A=document.createElement("button"),A.className="parvus__btn parvus__btn--close",A.setAttribute("type","button"),A.setAttribute("aria-label",u.l10n.closeButtonLabel),A.innerHTML=u.closeButtonIcon,b.appendChild(A),y=document.createElement("button"),y.className="parvus__btn parvus__btn--previous",y.setAttribute("type","button"),y.setAttribute("aria-label",u.l10n.previousButtonLabel),y.innerHTML=u.previousButtonIcon,b.appendChild(y),f=document.createElement("button"),f.className="parvus__btn parvus__btn--next",f.setAttribute("type","button"),f.setAttribute("aria-label",u.l10n.nextButtonLabel),f.innerHTML=u.nextButtonIcon,b.appendChild(f),E=document.createElement("div"),E.className="parvus__counter",m.appendChild(E),h.appendChild(m),h.appendChild(v),c.appendChild(h),document.body.appendChild(c)},R=e=>{if(void 0!==n[o].sliderElements[e]);else{const t=document.createElement("div"),s=document.createElement("div");t.className="parvus__slide",t.style.position="absolute",t.style.insetInlineStart=100*e+"%",n[o].gallery.length>1&&(t.setAttribute("role","group"),t.setAttribute("aria-label",`Image ${e+1} of ${n[o].gallery.length}`)),t.setAttribute("aria-hidden","true"),t.appendChild(s),n[o].sliderElements[e]=t,e===d&&n[o].slider.appendChild(t),e>d?n[o].sliderElements[d].after(t):n[o].sliderElements[d].before(t)}},U=e=>{if(!c||!e||!e.classList.contains("parvus-trigger")||Le())return;if(o=D(e),!n[o].gallery.includes(e))throw new Error("Ups, I can't find the element.");d=n[o].gallery.indexOf(e),B=document.activeElement;const t=window.location.href;history.pushState({parvus:"close"},"Image",t),Ee();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((e=>{e.setAttribute("aria-hidden","true"),e.classList.add("parvus-hidden")})),c.classList.add("parvus--is-opening"),c.setAttribute("aria-hidden","false"),n[o].slider=document.createElement("div"),n[o].slider.className="parvus__slider",n[o].gallery.length>1&&(n[o].slider.setAttribute("role","region"),n[o].slider.setAttribute("aria-roledescription","carousel"),n[o].slider.setAttribute("aria-label","Images")),n[o].slider.setAttribute("aria-hidden","true"),c.appendChild(n[o].slider),R(d),n[o].slider.setAttribute("aria-hidden","false"),ee(),ie(),se(),ce(),W(d),J(e,d,(()=>{K(d),requestAnimationFrame((()=>{c.classList.remove("parvus--is-opening"),p.style.opacity=1,p.style.transition=`opacity ${F}ms ${u.transitionTimingFunction}`,p.style.willChange="opacity"})),p.addEventListener("transitionend",(()=>{j(d+1),j(d-1)})),n[o].slider.classList.add("parvus__slider--animate")}));const s=new CustomEvent("open",{detail:{source:e}});c.dispatchEvent(s),document.body.classList.add("parvus-is-open")},P=()=>{if(!Le())throw new Error("Ups, I'm already closed.");const e=n[o].images[d],t=e.getBoundingClientRect(),s=(u.backFocus?n[o].gallery[d]:B).getBoundingClientRect();we(),ae(),null!==history.state&&"close"===history.state.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((e=>{e.removeAttribute("aria-hidden"),e.classList.remove("parvus-hidden")})),c.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{w=s.width/t.width,L=s.height/t.height,_=s.left-t.left,C=s.top-t.top,e.style.transform=`translate(${_}px, ${C}px) scale(${w}, ${L})`,e.style.opacity=0,e.style.transition=`transform ${F}ms ${u.transitionTimingFunction}, opacity ${F}ms ${u.transitionTimingFunction} ${F/2}ms`,p.style.opacity=0,p.style.transition=`opacity ${F}ms ${u.transitionTimingFunction}`,p.style.willChange="auto"})),p.addEventListener("transitionend",(()=>{Z(d),B=u.backFocus?n[o].gallery[d]:B,B.focus({preventScroll:!0}),c.setAttribute("aria-hidden","true"),c.classList.remove("parvus--is-closing"),c.classList.remove("parvus--is-vertical-closing"),e.style.transform="",n[o].slider.remove(),n[o].slider=null,n[o].sliderElements=[],n[o].images=[]}),{once:!0});const a=new CustomEvent("close",{detail:{source:n[o].gallery[d]}});c.dispatchEvent(a),document.body.classList.remove("parvus-is-open")},j=e=>{void 0!==n[o].gallery[e]&&(R(e),J(n[o].gallery[e],e,(()=>{K(e)})))},W=e=>{n[o].sliderElements[e].classList.add("parvus__slide--is-active"),n[o].sliderElements[e].setAttribute("aria-hidden","false")},J=(e,t,s)=>{if(void 0!==n[o].images[t]);else{const a=n[o].sliderElements[t].querySelector("div"),r=document.createElement("img"),i=document.createElement("div"),l=document.createElement("div"),d=e.querySelector("img"),c=document.createElement("div");if(i.className="parvus__content",l.className="parvus__caption",c.className="parvus__loader",c.setAttribute("role","progressbar"),c.setAttribute("aria-label",u.l10n.lightboxLoadingIndicatorLabel),a.appendChild(c),r.onload=()=>{a.removeChild(c),r.setAttribute("width",r.naturalWidth),r.setAttribute("height",r.naturalHeight),le(n[o].sliderElements[t],r),s&&"function"==typeof s&&s()},"A"===e.tagName?(r.setAttribute("src",e.href),r.alt=d?d.alt||"":e.getAttribute("data-alt")||""):(r.alt=e.getAttribute("data-alt")||"",r.setAttribute("src",e.getAttribute("data-target"))),e.hasAttribute("data-srcset")&&""!==e.getAttribute("data-srcset")&&r.setAttribute("srcset",e.getAttribute("data-srcset")),r.style.opacity=0,i.appendChild(r),n[o].images[t]=r,a.appendChild(i),u.captions){let s=null;if("self"===u.captionsSelector)e.hasAttribute(u.captionsAttribute)&&""!==e.getAttribute(u.captionsAttribute)&&(s=e.getAttribute(u.captionsAttribute));else if(null!==e.querySelector(u.captionsSelector)){const t=e.querySelector(u.captionsSelector);s=t.hasAttribute(u.captionsAttribute)&&""!==t.getAttribute(u.captionsAttribute)?t.getAttribute(u.captionsAttribute):t.innerHTML}null!==s&&(n[o].sliderElements[t].setAttribute("aria-labelledby",`parvus__caption-${t}`),l.id=`parvus__caption-${t}`,l.innerHTML=`<p>${s}</p>`,a.appendChild(l))}}},K=e=>{const t=n[o].images[e],s=t.getBoundingClientRect(),a=n[o].gallery[e].getBoundingClientRect();c.classList.contains("parvus--is-opening")?(w=a.width/s.width,L=a.height/s.height,_=a.left-s.left,C=a.top-s.top,requestAnimationFrame((()=>{t.style.transform=`translate(${_}px, ${C}px) scale(${w}, ${L})`,t.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{t.style.transform="",t.style.opacity=1,t.style.transition=`transform ${F}ms ${u.transitionTimingFunction}, opacity ${F/2}ms ${u.transitionTimingFunction}`}))}))):t.style.opacity=1},V=e=>{const t=d;if(!Le())throw new Error("Ups, I'm closed.");if(!e&&0!==e)throw new Error("Ups, no slide specified.");if(e===d)throw new Error(`Ups, slide ${e} is already selected.`);if(-1===e||e>=n[o].gallery.length)throw new Error(`Ups, I can't find slide ${e}.`);Z(t),W(e),K(e),e<t&&(d--,ee(),ie(),te("left"),j(e-1)),e>t&&(d++,ee(),ie(),te("right"),j(e+1)),se();const s=new CustomEvent("select",{detail:{source:n[o].gallery[d]}});c.dispatchEvent(s)},G=()=>{d>0&&V(d-1)},Q=()=>{d<n[o].gallery.length-1&&V(d+1)},Z=e=>{n[o].sliderElements[e].classList.remove("parvus__slide--is-active"),n[o].sliderElements[e].setAttribute("aria-hidden","true")},ee=()=>{o=null!==o?o:l,I=d*c.offsetWidth*-1,n[o].slider.style.transform=`translate3d(${I}px, 0, 0)`,M=I},te=e=>{1===n[o].gallery.length?A.focus():0===d?f.focus():d===n[o].gallery.length-1||"left"===e?y.focus():f.focus()},se=()=>{E.textContent=`${d+1}/${n[o].gallery.length}`},ae=()=>{x={startX:0,endX:0,startY:0,endY:0}},re=()=>{const e=x.endX-x.startX,t=x.endY-x.startY,s=Math.abs(e),a=Math.abs(t);$?e>2&&s>=u.threshold&&d>0?G():e<2&&s>=u.threshold&&d!==n[o].gallery.length-1?Q():ee():S?a>2&&u.swipeClose&&a>=u.threshold?P():(p.style.opacity=1,c.classList.remove("parvus--is-vertical-closing"),ee()):ee()},ie=()=>{((u.simulateTouch||_e())&&u.swipeClose&&!n[o].slider.classList.contains("parvus__slider--is-draggable")||(u.simulateTouch||_e())&&n[o].gallery.length>1&&!n[o].slider.classList.contains("parvus__slider--is-draggable"))&&n[o].slider.classList.add("parvus__slider--is-draggable"),1===n[o].gallery.length?(y.setAttribute("aria-hidden","true"),y.setAttribute("aria-disabled","true"),f.setAttribute("aria-hidden","true"),f.setAttribute("aria-disabled","true")):0===d?(y.setAttribute("aria-hidden","true"),y.setAttribute("aria-disabled","true"),f.setAttribute("aria-hidden","false"),f.setAttribute("aria-disabled","false")):d===n[o].gallery.length-1?(y.setAttribute("aria-hidden","false"),y.setAttribute("aria-disabled","false"),f.setAttribute("aria-hidden","true"),f.setAttribute("aria-disabled","true")):(y.setAttribute("aria-hidden","false"),y.setAttribute("aria-disabled","false"),f.setAttribute("aria-hidden","false"),f.setAttribute("aria-disabled","false")),1===n[o].gallery.length?E.setAttribute("aria-hidden","true"):E.setAttribute("aria-hidden","false")},ne=()=>{q||(q=!0,a.requestAnimationFrame((()=>{n[o].sliderElements.forEach(((e,t)=>{le(e,n[o].images[t])})),ee(),q=!1})))},le=(e,t)=>{const s=getComputedStyle(e),a=null!==e.querySelector(".parvus__caption")?e.querySelector(".parvus__caption").getBoundingClientRect().height:0,r=t.getAttribute("height"),i=t.getAttribute("width");let n=e.getBoundingClientRect().height,l=e.getBoundingClientRect().width;n-=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(a),l-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight);const o=Math.min(l/i||0,n/r),d=i*o||0,u=r*o||0;r>u&&r<n&&i>d&&i<l||r<u&&r<n&&i<d&&i<l?(t.style.width="",t.style.height=""):(t.style.width=`${d}px`,t.style.height=`${u}px`)},oe=function(e){e.preventDefault(),U(this)},de=e=>{e.target===y?G():e.target===f?Q():(e.target===A||!S&&!$&&e.target.classList.contains("parvus__slide")&&u.docClose)&&P(),e.stopPropagation()},ue=()=>Array.prototype.slice.call(c.querySelectorAll(`${r.join(", ")}`)).filter((e=>!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))),ce=()=>{ue()[0].focus()},pe=e=>{const t=ue(),s=t.indexOf(document.activeElement);"Tab"===e.code?e.shiftKey&&0===s?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||s!==t.length-1||(t[0].focus(),e.preventDefault()):"Escape"===e.code?(e.preventDefault(),P()):"ArrowLeft"===e.code?(e.preventDefault(),G()):"ArrowRight"===e.code&&(e.preventDefault(),Q())},ge=()=>{P()},he=e=>{e.preventDefault(),e.stopPropagation(),$=!1,S=!1,T=!0,x.startX=e.pageX,x.startY=e.pageY,n[o].slider.classList.add("parvus__slider--is-dragging"),n[o].slider.style.willChange="transform"},me=e=>{e.preventDefault(),T&&(x.endX=e.pageX,x.endY=e.pageY,Ae())},ve=e=>{e.stopPropagation(),T=!1,n[o].slider.classList.remove("parvus__slider--is-dragging"),n[o].slider.style.willChange="auto",(x.endX||x.endY)&&re(),ae()},be=e=>{e.stopPropagation(),$=!1,S=!1,T=!0,x.startX=e.touches[0].pageX,x.startY=e.touches[0].pageY,n[o].slider.classList.add("parvus__slider--is-dragging"),n[o].slider.style.willChange="transform"},ye=e=>{e.stopPropagation(),T&&(e.preventDefault(),x.endX=e.touches[0].pageX,x.endY=e.touches[0].pageY,Ae())},fe=e=>{e.stopPropagation(),T=!1,n[o].slider.classList.remove("parvus__slider--is-dragging"),n[o].slider.style.willChange="auto",(x.endX||x.endY)&&re(),ae()},Ae=()=>{const e=x.startX-x.endX,t=x.endY-x.startY,s=Math.abs(t);Math.abs(e)>2&&!S&&n[o].gallery.length>1?(n[o].slider.style.transform=`translate3d(${M-Math.round(e)}px, 0, 0)`,$=!0,S=!1):Math.abs(t)>2&&!$&&u.swipeClose&&(s<=96&&!N&&(g=1-s/100),c.classList.add("parvus--is-vertical-closing"),p.style.opacity=g,n[o].slider.style.transform=`translate3d(${M}px, ${Math.round(t)}px, 0)`,$=!1,S=!0)},Ee=()=>{a.addEventListener("keydown",pe),a.addEventListener("resize",ne),u.scrollClose&&a.addEventListener("wheel",ge),a.addEventListener("popstate",P),c.addEventListener("click",de),_e()&&(c.addEventListener("touchstart",be),c.addEventListener("touchmove",ye),c.addEventListener("touchend",fe)),u.simulateTouch&&(c.addEventListener("mousedown",he),c.addEventListener("mouseup",ve),c.addEventListener("mousemove",me))},we=()=>{a.removeEventListener("keydown",pe),a.removeEventListener("resize",ne),u.scrollClose&&a.removeEventListener("wheel",ge),a.removeEventListener("popstate",P),c.removeEventListener("click",de),_e()&&(c.removeEventListener("touchstart",be),c.removeEventListener("touchmove",ye),c.removeEventListener("touchend",fe)),u.simulateTouch&&(c.removeEventListener("mousedown",he),c.removeEventListener("mouseup",ve),c.removeEventListener("mousemove",me))},Le=()=>"false"===c.getAttribute("aria-hidden"),_e=()=>"ontouchstart"in window;return k(s),t.init=k,t.open=U,t.close=P,t.select=V,t.previous=G,t.next=Q,t.currentIndex=()=>d,t.add=O,t.remove=H,t.destroy=()=>{if(!c)return;Le()&&P(),c.remove();document.querySelectorAll(".parvus-trigger").forEach((e=>{H(e)}));const e=new CustomEvent("destroy");c.dispatchEvent(e)},t.isOpen=Le,t.on=(e,t)=>{c&&c.addEventListener(e,t)},t.off=(e,t)=>{c&&c.removeEventListener(e,t)},t}export{t as default};

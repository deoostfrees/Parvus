/**
 * Parvus
 *
 * @author de Oostfreese
 * @version 1.3.0
 * @url https://github.com/deoostfreese/parvus
 *
 * MIT license
 */
function e(t){const a=window,s=["button:not([disabled]):not([inert])",'[tabindex]:not([tabindex^="-"]):not([inert])'],n={gallery:[],slider:null,sliderElements:[]},i={};let r=null,o=null,l=0,d={},u=null,c=null,p=0,g=null,h=null,m=null,v=0,f=0,b=0,y=0,A={},w=!1,E=!1,L=!1,_=null,C=null,x=null,$=null,T=!0;const B=window.matchMedia("(prefers-reduced-motion)"),S=function(){B.matches?(T=!0,$=d.reducedTransitionDuration):(T=!1,$=d.transitionDuration)};B.addEventListener("change",S);const M=function(e){if(d=function(e){return{selector:".lightbox",gallerySelector:null,docClose:!0,scrollClose:!1,swipeClose:!0,threshold:100,backFocus:!0,transitionDuration:300,reducedTransitionDuration:.1,transitionTimingFunction:"cubic-bezier(0.5, 0, 0.14, 1)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M18 6L6 18M6 6l12 12"/></svg>',lang:"en",i18n:{en:{lightboxLabel:"This is a dialog window which overlays the main content of the page. The modal shows the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window"}},fileTypes:/\.(png|jpe?g|webp|avif|svg)(\?.*)?$/i,...e}}(e),S(),u||Y(),null!==d.gallerySelector){document.querySelectorAll(d.gallerySelector).forEach(((e,t)=>{const a=t;e.querySelectorAll(d.selector).forEach((e=>{e.setAttribute("data-group",`parvus-gallery-${a}`),I(e)}))}));document.querySelectorAll(`${d.selector}:not(.parvus-trigger)`).forEach((e=>{I(e)}))}else{document.querySelectorAll(d.selector).forEach((e=>{I(e)}))}},q=function(e){const t=Math.floor(1e4*Math.random());return e.hasAttribute("data-group")&&""!==e.getAttribute("data-group")||e.setAttribute("data-group",`default-${t}`),e.getAttribute("data-group")},I=function(e){var t;if("A"===e.tagName&&e.hasAttribute("href")&&e.href.match(d.fileTypes)||"BUTTON"===e.tagName&&e.hasAttribute("data-target")&&e.getAttribute("data-target").match(d.fileTypes))if(r=q(e),Object.prototype.hasOwnProperty.call(i,r)||(i[r]=(t=n,JSON.parse(JSON.stringify(t)))),-1===i[r].gallery.indexOf(e)){if(i[r].gallery.push(e),null!==e.querySelector("img")){const t=document.createElement("div");e.classList.add("parvus-zoom"),t.className="parvus-zoom__indicator",t.innerHTML=d.lightboxIndicatorIcon,e.appendChild(t)}e.classList.add("parvus-trigger"),e.addEventListener("click",Q),ge()&&r===o&&(G(),J())}else console.log("Ups, element already added.");else console.log(e,`Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file. Supported image file types: ${d.fileTypes}.`)},X=function(e){const t=q(e);if(-1===i[t].gallery.indexOf(e))throw new Error(`Ups, I can't find a slide for the element ${e}.`);{const a=i[t].gallery.indexOf(e);if(ge()&&t===o&&a===l){if(1===i[t].gallery.length)throw N(),new Error("Ups, I've closed. There are no slides more to show.");0===l?R():U()}if(e.classList.contains("parvus-zoom")){const t=e.querySelector(".parvus-zoom__indicator");e.classList.remove("parvus-zoom"),e.removeChild(t)}e.removeEventListener("click",Q),e.classList.remove("parvus-trigger"),i[t].slider.removeChild(i[t].sliderElements[a])}},Y=function(){u=document.createElement("div"),u.setAttribute("role","dialog"),u.setAttribute("aria-modal","true"),u.setAttribute("aria-hidden","true"),u.setAttribute("tabindex","-1"),u.setAttribute("aria-label",d.i18n[d.lang].lightboxLabel),u.classList.add("parvus"),c=document.createElement("div"),c.classList.add("parvus__overlay"),c.style.opacity=0,u.appendChild(c),m=document.createElement("button"),m.className="parvus__btn parvus__btn--close",m.setAttribute("type","button"),m.setAttribute("aria-label",d.i18n[d.lang].closeButtonLabel),m.innerHTML=d.closeButtonIcon,u.appendChild(m),g=document.createElement("button"),g.className="parvus__btn parvus__btn--previous",g.setAttribute("type","button"),g.setAttribute("aria-label",d.i18n[d.lang].previousButtonLabel),g.innerHTML=d.previousButtonIcon,u.appendChild(g),h=document.createElement("button"),h.className="parvus__btn parvus__btn--next",h.setAttribute("type","button"),h.setAttribute("aria-label",d.i18n[d.lang].nextButtonLabel),h.innerHTML=d.nextButtonIcon,u.appendChild(h),document.body.appendChild(u)},k=function(e,t){const a=document.createElement("div"),s=document.createElement("div");a.className="parvus__slide",a.style.position="absolute",a.style.left=100*t+"%",a.setAttribute("aria-hidden","true"),H(e,s),a.appendChild(s),i[o].sliderElements[t]=a,t===l&&i[o].slider.appendChild(a),t>l?i[o].sliderElements[l].after(a):i[o].sliderElements[l].before(a)},F=function(e){if(ge())throw new Error("Ups, I'm aleady open.");_=document.activeElement;const t=window.location.href;history.pushState({parvus:"close"},"Image",t),ce();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((e=>{e.setAttribute("aria-hidden","true"),e.classList.add("parvus-hidden")})),u.classList.add("parvus--is-opening"),u.setAttribute("aria-hidden","false"),i[o].slider=document.createElement("div"),i[o].slider.className="parvus__slider",i[o].slider.setAttribute("aria-hidden","true"),u.appendChild(i[o].slider),k(i[o].gallery[e],e),G(),te(),i[o].slider.setAttribute("aria-hidden","false"),O(e),requestAnimationFrame((()=>{u.classList.remove("parvus--is-opening"),c.style.opacity=1,c.style.transition=`opacity ${$}ms ${d.transitionTimingFunction}`,c.style.willChange="opacity"})),W(),P(e,"open"),D(e+1),D(e-1),setTimeout((()=>{i[o].slider.classList.add("parvus__slider--animate")}),$);const a=new CustomEvent("open");u.dispatchEvent(a)},N=function(){if(!ge())throw new Error("Ups, I'm already closed.");const e=i[o].sliderElements[l].querySelector("img"),t=e.getBoundingClientRect(),a=(d.backFocus?i[o].gallery[l]:_).getBoundingClientRect();pe(),K(),null!==history.state&&"close"===history.state.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((e=>{e.removeAttribute("aria-hidden"),e.classList.remove("parvus-hidden")})),u.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{v=a.width/t.width,f=a.height/t.height,b=a.left-t.left,y=a.top-t.top,e.style.transform=`translate(${b}px, ${y}px) scale(${v}, ${f})`,e.style.opacity=0,e.style.transition=`transform ${$}ms ${d.transitionTimingFunction}, opacity ${$}ms ${d.transitionTimingFunction}`,c.style.opacity=0,c.style.transition=`opacity ${$}ms ${d.transitionTimingFunction}`,c.style.willChange="auto"})),c.addEventListener("transitionend",(()=>{j(l),_=d.backFocus?i[o].gallery[l]:_,_.focus({preventScroll:!0}),u.setAttribute("aria-hidden","true"),u.classList.remove("parvus--is-closing"),u.classList.remove("parvus--is-vertical-closing"),i[o].slider.remove(),e.style.transform=""}),{once:!0});const s=new CustomEvent("close");u.dispatchEvent(s)},D=function(e){void 0!==i[o].gallery[e]&&(k(i[o].gallery[e],e),P(e,"preload"))},O=function(e){void 0!==i[o].sliderElements[e]&&(i[o].sliderElements[e].classList.add("parvus__slide--is-active"),i[o].sliderElements[e].setAttribute("aria-hidden","false"))},H=function(e,t){const a=document.createElement("img"),s=document.createElement("figure"),n=document.createElement("figcaption"),i=e.querySelector("img");"A"===e.tagName?(a.setAttribute("data-src",e.href),a.alt=i?i.alt||"":e.getAttribute("data-alt")||""):(a.alt=e.getAttribute("data-alt")||"",a.setAttribute("data-src",e.getAttribute("data-target"))),e.hasAttribute("data-srcset")&&""!==e.getAttribute("data-srcset")&&a.setAttribute("data-srcset",e.getAttribute("data-srcset")),a.style.opacity=0,s.appendChild(a),e.hasAttribute("data-caption")&&""!==e.getAttribute("data-caption")&&(n.innerHTML=e.getAttribute("data-caption"),s.appendChild(n)),t.appendChild(s)},z=function(e){const t=i[o].sliderElements[e].querySelector("img"),a=t.getBoundingClientRect(),s=i[o].gallery[e].getBoundingClientRect();v=s.width/a.width,f=s.height/a.height,b=s.left-a.left,y=s.top-a.top,requestAnimationFrame((()=>{t.style.transform=`translate(${b}px, ${y}px) scale(${v}, ${f})`,t.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{t.style.transform="",t.style.opacity=1,t.style.transition=`transform ${$}ms ${d.transitionTimingFunction}, opacity ${$}ms ${d.transitionTimingFunction}`}))}))},P=function(e,t){const a=i[o].sliderElements[e],s=a.querySelector("img"),n=document.createElement("div");if(!s.hasAttribute("data-src"))return"open"===t&&z(e),void("navigate"===t&&(s.style.opacity=1));n.className="parvus__loader",n.setAttribute("role","progressbar"),n.setAttribute("aria-label",d.i18n[d.lang].lightboxLoadingIndicatorLabel),a.appendChild(n),s.onload=()=>{a.removeChild(n),s.setAttribute("width",s.naturalWidth),s.setAttribute("height",s.naturalHeight),"preload"===t?s.style.opacity=1:z(e)},s.hasAttribute("data-srcset")&&(s.setAttribute("srcset",s.getAttribute("data-srcset")),s.removeAttribute("data-srcset")),s.setAttribute("src",s.getAttribute("data-src")),s.removeAttribute("data-src")},U=function(){ge()&&l>0&&(j(l),--l,O(l),P(l,"navigate"),W(),G(),J("left"),D(l-1))},R=function(){ge()&&l<i[o].gallery.length-1&&(j(l),++l,O(l),P(l,"navigate"),W(),G(),J("right"),D(l+1))},j=function(e){void 0!==i[o].sliderElements[e]&&(i[o].sliderElements[e].classList.remove("parvus__slide--is-active"),i[o].sliderElements[e].setAttribute("aria-hidden","true"))},W=function(){o=null!==o?o:r,C=-l*u.offsetWidth,i[o].slider.style.transform=`translate3d(${C}px, 0, 0)`,x=C},J=function(e){1===i[o].gallery.length?m.focus():0===l?h.focus():l===i[o].gallery.length-1||"left"===e?g.focus():h.focus()},K=function(){A={startX:0,endX:0,startY:0,endY:0}},V=function(){const e=A.endX-A.startX,t=A.endY-A.startY,a=Math.abs(e),s=Math.abs(t);w&&e>0&&a>=d.threshold&&l>0?U():w&&e<0&&a>=d.threshold&&l!==i[o].gallery.length-1?R():E&&s>0?s>=d.threshold&&d.swipeClose?N():(c.style.opacity=1,u.classList.remove("parvus--is-vertical-closing"),W()):W()},G=function(){(d.swipeClose&&!i[o].slider.classList.contains("parvus__slider--is-draggable")||i[o].gallery.length>1&&!i[o].slider.classList.contains("parvus__slider--is-draggable"))&&i[o].slider.classList.add("parvus__slider--is-draggable"),1===i[o].gallery.length?(g.setAttribute("aria-hidden","true"),g.disabled=!0,h.setAttribute("aria-hidden","true"),h.disabled=!0):0===l?(g.setAttribute("aria-hidden","true"),g.disabled=!0,h.setAttribute("aria-hidden","false"),h.disabled=!1):l===i[o].gallery.length-1?(g.setAttribute("aria-hidden","false"),g.disabled=!1,h.setAttribute("aria-hidden","true"),h.disabled=!0):(g.setAttribute("aria-hidden","false"),g.disabled=!1,h.setAttribute("aria-hidden","false"),h.disabled=!1)},Q=function(e){e.preventDefault(),o=q(this),l=i[o].gallery.indexOf(this),F(l)},Z=function(e){e.target===g?U():e.target===h?R():(e.target===m||!E&&!w&&e.target.classList.contains("parvus__slide")&&d.docClose)&&N(),e.stopPropagation()},ee=function(){return Array.prototype.slice.call(u.querySelectorAll(`${s.join(", ")}`)).filter((function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}))},te=function(){ee()[0].focus()},ae=function(e){const t=ee(),a=t.indexOf(document.activeElement);"Tab"===e.code?e.shiftKey&&0===a?(t[t.length-1].focus(),e.preventDefault()):e.shiftKey||a!==t.length-1||(t[0].focus(),e.preventDefault()):"Escape"===e.code?(e.preventDefault(),N()):"ArrowLeft"===e.code?(e.preventDefault(),U()):"ArrowRight"===e.code&&(e.preventDefault(),R())},se=function(){N()},ne=function(e){e.preventDefault(),e.stopPropagation(),w=!1,E=!1,L=!0,A.startX=e.pageX,A.startY=e.pageY,i[o].slider.classList.add("parvus__slider--is-dragging"),i[o].slider.style.willChange="transform"},ie=function(e){e.preventDefault(),L&&(A.endX=e.pageX,A.endY=e.pageY,ue())},re=function(e){e.stopPropagation(),L=!1,i[o].slider.classList.remove("parvus__slider--is-dragging"),i[o].slider.style.willChange="auto",(A.endX||A.endY)&&V(),K()},oe=function(e){e.stopPropagation(),w=!1,E=!1,L=!0,A.startX=e.touches[0].pageX,A.startY=e.touches[0].pageY,i[o].slider.classList.add("parvus__slider--is-dragging"),i[o].slider.style.willChange="transform"},le=function(e){e.stopPropagation(),L&&(e.preventDefault(),A.endX=e.touches[0].pageX,A.endY=e.touches[0].pageY,ue())},de=function(e){e.stopPropagation(),L=!1,i[o].slider.classList.remove("parvus__slider--is-dragging"),i[o].slider.style.willChange="auto",(A.endX||A.endY)&&V(),K()},ue=function(){const e=A.startX-A.endX,t=A.endY-A.startY,a=Math.abs(t);Math.abs(e)>0&&!E&&i[o].gallery.length>1&&!T?(i[o].slider.style.transform=`translate3d(${x-Math.round(e)}px, 0, 0)`,w=!0,E=!1):Math.abs(t)>0&&!w&&d.swipeClose&&!T&&(a<=96&&(p=1-a/100),u.classList.add("parvus--is-vertical-closing"),c.style.opacity=p,i[o].slider.style.transform=`translate3d(${x}px, ${Math.round(t)}px, 0)`,w=!1,E=!0)},ce=function(){a.addEventListener("keydown",ae),d.scrollClose&&a.addEventListener("wheel",se),a.addEventListener("popstate",N),u.addEventListener("click",Z),he()&&(u.addEventListener("touchstart",oe),u.addEventListener("touchmove",le),u.addEventListener("touchend",de)),u.addEventListener("mousedown",ne),u.addEventListener("mouseup",re),u.addEventListener("mousemove",ie)},pe=function(){a.removeEventListener("keydown",ae),d.scrollClose&&a.removeEventListener("wheel",se),a.removeEventListener("popstate",N),u.removeEventListener("click",Z),he()&&(u.removeEventListener("touchstart",oe),u.removeEventListener("touchmove",le),u.removeEventListener("touchend",de)),u.removeEventListener("mousedown",ne),u.removeEventListener("mouseup",re),u.removeEventListener("mousemove",ie)},ge=function(){return"false"===u.getAttribute("aria-hidden")},he=function(){return"ontouchstart"in window};return M(t),e.init=M,e.open=F,e.close=N,e.previous=U,e.next=R,e.add=I,e.remove=X,e.destroy=function(){ge()&&N();document.querySelectorAll(".parvus-zoom").forEach((e=>{X(e)}));const e=new CustomEvent("destroy");u.dispatchEvent(e)},e.isOpen=ge,e.on=function(e,t){u.addEventListener(e,t)},e.off=function(e,t){u.removeEventListener(e,t)},e}export default e;

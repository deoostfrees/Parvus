/**
 * Parvus
 *
 * @author de Oostfreese
 * @version 1.3.0
 * @url https://github.com/deoostfreese/parvus
 *
 * MIT license
 */
function t(e){const n=window,i=["button:not([disabled]):not([inert])",'[tabindex]:not([tabindex^="-"]):not([inert])'],s={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},a={};let r,o,l,d,u=null,c=null,p={},m=null,h=null,g=0,v=null,f=null,b=null,y=null,L={},E=!1,w=!1,A=!1,x=null,_=null,I=null,C=null,$=!0;const T=window.matchMedia("(prefers-reduced-motion)"),B=function(){T.matches?($=!0,C=p.reducedTransitionDuration):($=!1,C=p.transitionDuration)};T.addEventListener("change",B);const M=function(t){p=function(t){return{selector:".lightbox",docClose:!0,scrollClose:!1,swipeClose:!0,threshold:100,transitionDuration:300,reducedTransitionDuration:.1,transitionTimingFunction:"cubic-bezier(0.2, 0, 0.2, 1)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M18 6L6 18M6 6l12 12"/></svg>',lang:"en",i18n:{en:{lightboxLabel:"This is a dialog window which overlays the main content of the page. The modal shows the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window"}},fileTypes:/\.(png|jpe?g|webp|avif|svg)(\?.*)?$/i,...t}}(t),B(),m||D();document.querySelectorAll(p.selector).forEach((t=>{X(t)}))},N=function(t){return t.hasAttribute("data-group")?t.getAttribute("data-group"):"default"},X=function(t){var e;if("A"===t.tagName&&t.hasAttribute("href")&&t.href.match(p.fileTypes)||"BUTTON"===t.tagName&&t.hasAttribute("data-target")&&t.getAttribute("data-target").match(p.fileTypes))if(u=N(t),Object.prototype.hasOwnProperty.call(a,u)||(a[u]=(e=s,JSON.parse(JSON.stringify(e))),F()),-1===a[u].gallery.indexOf(t)){if(a[u].gallery.push(t),a[u].elementsLength++,null!==t.querySelector("img")){t.classList.add("parvus-zoom");const e=document.createElement("div");e.className="parvus-zoom__indicator",e.innerHTML=p.lightboxIndicatorIcon,t.appendChild(e)}t.classList.add("parvus-trigger"),t.addEventListener("click",V),S(t),pt()&&u===c&&G()}else console.log("Ups, element already added.");else console.log(t,`Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must have a path to the image file. Supported image file types: ${p.fileTypes}.`)},Y=function(t){t.classList.contains("parvus-zoom")&&(t.classList.remove("parvus-zoom"),t.removeEventListener("click",V))},D=function(){m=document.createElement("div"),m.setAttribute("role","dialog"),m.setAttribute("aria-modal","true"),m.setAttribute("aria-hidden","true"),m.setAttribute("tabindex","-1"),m.setAttribute("aria-label",p.i18n[p.lang].lightboxLabel),m.classList.add("parvus"),h=document.createElement("div"),h.classList.add("parvus__overlay"),h.style.opacity=0,m.appendChild(h),y=document.createElement("button"),y.className="parvus__btn parvus__btn--close",y.setAttribute("type","button"),y.setAttribute("aria-label",p.i18n[p.lang].closeButtonLabel),y.innerHTML=p.closeButtonIcon,y.style.opacity=0,m.appendChild(y),f=document.createElement("button"),f.className="parvus__btn parvus__btn--previous",f.setAttribute("type","button"),f.setAttribute("aria-label",p.i18n[p.lang].previousButtonLabel),f.innerHTML=p.previousButtonIcon,f.style.opacity=0,m.appendChild(f),b=document.createElement("button"),b.className="parvus__btn parvus__btn--next",b.setAttribute("type","button"),b.setAttribute("aria-label",p.i18n[p.lang].nextButtonLabel),b.innerHTML=p.nextButtonIcon,b.style.opacity=0,m.appendChild(b),document.body.appendChild(m)},F=function(){a[u].slider=document.createElement("div"),a[u].slider.className="parvus__slider",a[u].slider.setAttribute("aria-hidden","true"),m.appendChild(a[u].slider)},S=function(t){const e=document.createElement("div"),n=document.createElement("div");e.className="parvus__slide",e.style.position="absolute",e.style.left=100*a[u].x+"%",e.setAttribute("aria-hidden","true"),P(t,n),e.appendChild(n),a[u].slider.appendChild(e),a[u].sliderElements.push(e),++a[u].x},k=function(t){if(pt())throw new Error("Ups, I'm aleady open.");G(),x=document.activeElement;const e=window.location.href;history.pushState({parvus:"close"},"Image",e),a[c].currentIndex=t,ut();document.querySelectorAll('body > *:not([aria-hidden="true"])').forEach((t=>{t.setAttribute("aria-hidden","true"),t.classList.add("parvus-hidden")})),m.setAttribute("aria-hidden","false"),tt(),requestAnimationFrame((()=>{y.style.opacity=1,y.style.transition=`opacity ${C}ms ${p.transitionTimingFunction}, transform ${C}ms ${p.transitionTimingFunction}`,f.style.opacity=1,f.style.transition=`opacity ${C}ms ${p.transitionTimingFunction}, transform ${C}ms ${p.transitionTimingFunction}`,b.style.opacity=1,b.style.transition=`opacity ${C}ms ${p.transitionTimingFunction}, transform ${C}ms ${p.transitionTimingFunction}`,h.style.opacity=1,h.style.transition=`opacity ${C}ms ${p.transitionTimingFunction}`})),a[c].slider.setAttribute("aria-hidden","false"),H(a[c].currentIndex),W(),z(a[c].currentIndex),O(a[c].currentIndex+1),O(a[c].currentIndex-1);const n=new CustomEvent("open");m.dispatchEvent(n)},q=function(){if(!pt())throw new Error("Ups, I'm already closed.");ct(),J(),null!==history.state&&"close"===history.state.parvus&&history.back();document.querySelectorAll(".parvus-hidden").forEach((t=>{t.removeAttribute("aria-hidden"),t.classList.remove("parvus-hidden")})),m.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{h.style.opacity=.1,h.style.transition=`opacity ${C}ms ${p.transitionTimingFunction}`})),h.addEventListener("transitionend",(()=>{j(a[c].currentIndex),x.focus({preventScroll:!0}),a[c].slider.setAttribute("aria-hidden","true"),m.setAttribute("aria-hidden","true"),m.classList.remove("parvus--is-closing"),y.style.opacity=0,f.style.opacity=0,b.style.opacity=0}),{once:!0});const t=new CustomEvent("close");m.dispatchEvent(t)},O=function(t){a[c].sliderElements[t]},H=function(t){void 0!==a[c].sliderElements[t]&&(a[c].sliderElements[t].classList.add("parvus__slide--is-active"),a[c].sliderElements[t].setAttribute("aria-hidden","false"))},P=function(t,e){const n=document.createElement("figure"),i=document.createElement("figurecaption"),s=t.querySelector("img");v=document.createElement("img"),"A"===t.tagName?(v.setAttribute("data-src",t.href),v.alt=s?s.alt||"":t.getAttribute("data-alt")||""):(v.alt=t.getAttribute("data-alt")||"",v.setAttribute("data-src",t.getAttribute("data-target"))),n.appendChild(v),t.hasAttribute("data-caption")&&""!==t.getAttribute("data-caption")&&(i.innerHTML=t.getAttribute("data-caption"),n.appendChild(i)),e.appendChild(n)},z=function(t){const e=a[c].sliderElements[t],n=e.querySelector("img"),i=a[c].gallery[t].getBoundingClientRect(),s=document.createElement("div");n.hasAttribute("data-src")&&(n.style.opacity=0,s.className="parvus__loader",s.setAttribute("role","progressbar"),s.setAttribute("aria-label",p.i18n[p.lang].lightboxLOADING_INDICATORLabel),e.appendChild(s),n.onload=()=>{const t=n.getBoundingClientRect();e.removeChild(s),r=i.width/t.width,o=i.height/t.height,l=i.left-t.left,d=i.top-t.top,n.setAttribute("width",n.naturalWidth),n.setAttribute("height",n.naturalHeight),requestAnimationFrame((()=>{n.style.transform=`translate(${l}px, ${d}px) scale(${r}, ${o})`,n.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{n.style.transform="",n.style.opacity=1,n.style.transition=`transform ${C}ms ${p.transitionTimingFunction}, opacity ${C}ms ${p.transitionTimingFunction}`}))}))},n.setAttribute("src",n.getAttribute("data-src")),n.removeAttribute("data-src"))},R=function(){pt()&&a[c].currentIndex>0&&(j(a[c].currentIndex),--a[c].currentIndex,H(a[c].currentIndex),z(a[c].currentIndex),W(),O(a[c].currentIndex-1))},U=function(){pt()&&a[c].currentIndex<a[c].elementsLength-1&&(j(a[c].currentIndex),++a[c].currentIndex,H(a[c].currentIndex),z(a[c].currentIndex),W(),O(a[c].currentIndex+1))},j=function(t){void 0!==a[c].sliderElements[t]&&(a[c].sliderElements[t].classList.remove("parvus__slide--is-active"),a[c].sliderElements[t].setAttribute("aria-hidden","true"))},W=function(){c=null!==c?c:u,_=-a[c].currentIndex*m.offsetWidth,a[c].slider.style.transform=`translate3d(${_}px, 0, 0)`,I=_},J=function(){L={startX:0,endX:0,startY:0,endY:0}},K=function(){const t=L.endX-L.startX,e=L.endY-L.startY,n=Math.abs(t),i=Math.abs(e);E&&t>0&&n>=p.threshold&&a[c].currentIndex>0?R():E&&t<0&&n>=p.threshold&&a[c].currentIndex!==a[c].elementsLength-1?U():w&&i>0?i>=p.threshold&&p.swipeClose?q():(h.style.opacity=1,m.classList.remove("parvus--is-closing"),W()):W()},G=function(){(p.swipeClose&&!a[c].slider.classList.contains("parvus__slider--is-draggable")||a[c].elementsLength>1&&!a[c].slider.classList.contains("parvus__slider--is-draggable"))&&a[c].slider.classList.add("parvus__slider--is-draggable"),1===a[c].elementsLength?(f.setAttribute("aria-hidden","true"),f.disabled=!0,b.setAttribute("aria-hidden","true"),b.disabled=!0):(f.setAttribute("aria-hidden","false"),f.disabled=!1,b.setAttribute("aria-hidden","false"),b.disabled=!1)},V=function(t){t.preventDefault(),c=N(this),k(a[c].gallery.indexOf(this))},Q=function(t){t.target===f?R():t.target===b?U():(t.target===y||!w&&!E&&t.target.classList.contains("parvus__slide")&&p.docClose)&&q(),t.stopPropagation()},Z=function(){return Array.prototype.slice.call(m.querySelectorAll(`${i.join(", ")}`)).filter((function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}))},tt=function(){Z()[0].focus()},et=function(t){const e=Z(),n=e.indexOf(document.activeElement);"Tab"===t.code?t.shiftKey&&0===n?(e[e.length-1].focus(),t.preventDefault()):t.shiftKey||n!==e.length-1||(e[0].focus(),t.preventDefault()):"Escape"===t.code?(t.preventDefault(),q()):"ArrowLeft"===t.code?(t.preventDefault(),R()):"ArrowRight"===t.code&&(t.preventDefault(),U())},nt=function(){q()},it=function(t){t.preventDefault(),t.stopPropagation(),E=!1,w=!1,A=!0,L.startX=t.pageX,L.startY=t.pageY,a[c].slider.classList.add("parvus__slider--is-dragging")},st=function(t){t.preventDefault(),A&&(L.endX=t.pageX,L.endY=t.pageY,dt())},at=function(t){t.stopPropagation(),A=!1,a[c].slider.classList.remove("parvus__slider--is-dragging"),(L.endX||L.endY)&&K(),J()},rt=function(t){t.stopPropagation(),E=!1,w=!1,A=!0,L.startX=t.touches[0].pageX,L.startY=t.touches[0].pageY,a[c].slider.classList.add("parvus__slider--is-dragging")},ot=function(t){t.stopPropagation(),A&&(t.preventDefault(),L.endX=t.touches[0].pageX,L.endY=t.touches[0].pageY,dt())},lt=function(t){t.stopPropagation(),A=!1,a[c].slider.classList.remove("parvus__slider--is-dragging"),(L.endX||L.endY)&&K(),J()},dt=function(){const t=L.startX-L.endX,e=L.endY-L.startY,n=Math.abs(e);Math.abs(t)>0&&!w&&a[c].elementsLength>1&&!$?(a[c].slider.style.transform=`translate3d(${I-Math.round(t)}px, 0, 0)`,E=!0,w=!1):Math.abs(e)>0&&!E&&p.swipeClose&&!$&&(n<=100&&(g=1-n/100),m.classList.add("parvus--is-closing"),h.style.opacity=g,a[c].slider.style.transform=`translate3d(${I}px, ${Math.round(e)}px, 0)`,E=!1,w=!0)},ut=function(){n.addEventListener("keydown",et),p.scrollClose&&n.addEventListener("wheel",nt),n.addEventListener("popstate",q),m.addEventListener("click",Q),mt()&&(m.addEventListener("touchstart",rt),m.addEventListener("touchmove",ot),m.addEventListener("touchend",lt)),m.addEventListener("mousedown",it),m.addEventListener("mouseup",at),m.addEventListener("mousemove",st)},ct=function(){n.removeEventListener("keydown",et),p.scrollClose&&n.removeEventListener("wheel",nt),n.removeEventListener("popstate",q),m.removeEventListener("click",Q),mt()&&(m.removeEventListener("touchstart",rt),m.removeEventListener("touchmove",ot),m.removeEventListener("touchend",lt)),m.removeEventListener("mousedown",it),m.removeEventListener("mouseup",at),m.removeEventListener("mousemove",st)},pt=function(){return"false"===m.getAttribute("aria-hidden")},mt=function(){return"ontouchstart"in window};return M(e),t.init=M,t.open=k,t.close=q,t.previous=R,t.next=U,t.add=X,t.remove=Y,t.destroy=function(){pt()&&q();document.querySelectorAll(".parvus-zoom").forEach((t=>{Y(t)}));const t=new CustomEvent("destroy");m.dispatchEvent(t)},t.isOpen=pt,t.on=function(t,e){m.addEventListener(t,e)},t.off=function(t,e){m.removeEventListener(t,e)},t}export default t;

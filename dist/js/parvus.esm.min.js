/**
 * Parvus
 *
 * @author Benjamin de Oostfrees
 * @version 2.6.0
 * @url https://github.com/deoostfrees/parvus
 *
 * MIT license
 */

const e=['a:not([inert]):not([tabindex^="-"])','button:not([inert]):not([tabindex^="-"]):not(:disabled)','[tabindex]:not([inert]):not([tabindex^="-"])'],t=window,r=()=>t.innerWidth-document.documentElement.clientWidth;var n={lightboxLabel:"This is a dialog window that overlays the main content of the page. The modal displays the enlarged image. Pressing the Escape key will close the modal and bring you back to where you were on the page.",lightboxLoadingIndicatorLabel:"Image loading",lightboxLoadingError:"The requested image cannot be loaded.",controlsLabel:"Controls",previousButtonLabel:"Previous image",nextButtonLabel:"Next image",closeButtonLabel:"Close dialog window",sliderLabel:"Images",slideLabel:"Image"};function s(t){const s=window,i={triggerElements:[],slider:null,sliderElements:[],contentElements:[]},a={};let o=0,l=null,d=null,u=0,c={},p=null,m=null,g=1,h=null,v=null,b=null,f=null,E=null,A=null,y=null,w=null,L={},_=!1,C=!1,x=!1,$=null,k=null,I=!1,S=null,M=!0;const T=s.matchMedia("(prefers-reduced-motion)"),B=()=>{T.matches?(M=!0,S=.1):(M=!1,S=c.transitionDuration)},N=e=>{const t=e.dataset.group||`default-${o}`;return++o,e.hasAttribute("data-group")||e.setAttribute("data-group",t),t},q=e=>{if(p||Y(),!("A"===e.tagName&&e.hasAttribute("href")||"BUTTON"===e.tagName&&e.hasAttribute("data-target")))throw new Error("Use a link with the 'href' attribute or a button with the 'data-target' attribute. Both attributes must contain a path to the image file.");if(l=N(e),a[l]||(a[l]=structuredClone(i)),a[l].triggerElements.includes(e))throw new Error("Ups, element already added.");if(a[l].triggerElements.push(e),((e,t)=>{if(e.querySelector("img")&&null===e.querySelector(".parvus-zoom__indicator")){const r=document.createElement("div");r.className="parvus-zoom__indicator",r.innerHTML=t.lightboxIndicatorIcon,e.appendChild(r)}})(e,c),e.classList.add("parvus-trigger"),e.addEventListener("click",ne),he()&&l===d){const t=a[l].triggerElements.indexOf(e);F(t),P(e,t,(()=>{R(t)})),ee(),V(),J()}},X=e=>{if(!e||!e.hasAttribute("data-group"))return;const t=N(e);if(!a[t]||!a[t].triggerElements.includes(e))return;const r=a[t].triggerElements.indexOf(e);a[t].triggerElements.splice(r,1),a[t].sliderElements.splice(r,1),(e=>{if(e.querySelector("img")&&null!==e.querySelector(".parvus-zoom__indicator")){const t=e.querySelector(".parvus-zoom__indicator");e.removeChild(t)}})(e),he()&&t===d&&(ee(),V(),J()),e.removeEventListener("click",ne),e.classList.remove("parvus-trigger")},Y=()=>{p=document.createElement("dialog"),p.setAttribute("aria-label",c.l10n.lightboxLabel),p.classList.add("parvus"),m=document.createElement("div"),m.classList.add("parvus__overlay"),p.appendChild(m),h=document.createElement("div"),h.className="parvus__toolbar",v=document.createElement("div"),b=document.createElement("div"),f=document.createElement("div"),f.className="parvus__controls",f.setAttribute("role","group"),f.setAttribute("aria-label",c.l10n.controlsLabel),b.appendChild(f),y=document.createElement("button"),y.className="parvus__btn parvus__btn--close",y.setAttribute("type","button"),y.setAttribute("aria-label",c.l10n.closeButtonLabel),y.innerHTML=c.closeButtonIcon,f.appendChild(y),E=document.createElement("button"),E.className="parvus__btn parvus__btn--previous",E.setAttribute("type","button"),E.setAttribute("aria-label",c.l10n.previousButtonLabel),E.innerHTML=c.previousButtonIcon,f.appendChild(E),A=document.createElement("button"),A.className="parvus__btn parvus__btn--next",A.setAttribute("type","button"),A.setAttribute("aria-label",c.l10n.nextButtonLabel),A.innerHTML=c.nextButtonIcon,f.appendChild(A),w=document.createElement("div"),w.className="parvus__counter",v.appendChild(w),h.appendChild(v),h.appendChild(b),p.appendChild(h),document.body.appendChild(p)},F=e=>{if(void 0!==a[d].sliderElements[e])return;const t=document.createElement("div"),r=document.createElement("div"),n=a[d].triggerElements.length;if(t.className="parvus__slide",t.style.position="absolute",t.style.left=100*e+"%",t.setAttribute("aria-hidden","true"),t.appendChild(r),n>1&&(t.setAttribute("role","group"),t.setAttribute("aria-label",`${c.l10n.slideLabel} ${e+1}/${n}`)),a[d].sliderElements[e]=t,e>=u){const r=(e=>{const t=a[d].sliderElements,r=t.length;for(let n=e+1;n<r;n++)if(void 0!==t[n])return n;return-1})(e);-1!==r?a[d].sliderElements[r].before(t):a[d].slider.appendChild(t)}else{const r=(e=>{const t=a[d].sliderElements;for(let r=e-1;r>=0;r--)if(void 0!==t[r])return r;return-1})(e);-1!==r?a[d].sliderElements[r].after(t):a[d].slider.prepend(t)}},z=e=>{if(p&&e&&e.classList.contains("parvus-trigger")&&!he()){if(d=N(e),!a[d].triggerElements.includes(e))throw new Error("Ups, I can't find the element.");u=a[d].triggerElements.indexOf(e),history.pushState({parvus:"close"},"Image",window.location.href),me(),c.hideScrollbar&&(document.body.style.marginInlineEnd=`${r()}px`,document.body.style.overflow="hidden"),p.classList.add("parvus--is-opening"),p.showModal(),(()=>{const e=document.createElement("div");e.className="parvus__slider",e.setAttribute("aria-hidden","true"),a[d].slider=e,p.appendChild(e)})(),F(u),a[d].slider.setAttribute("aria-hidden","false"),K(),ee(),V(),J(),O(u),P(e,u,(()=>{R(u,!0),p.classList.remove("parvus--is-opening"),a[d].slider.classList.add("parvus__slider--animate")})),D(u+1),D(u-1),be("open")}},H=()=>{if(!he())throw new Error("Ups, I'm already closed.");const e=a[d].contentElements[u],t=a[d].triggerElements[u];ge(),Q(),"close"===history.state?.parvus&&history.back(),p.classList.add("parvus--is-closing"),requestAnimationFrame((()=>{const r=t.getBoundingClientRect();if(e&&"IMG"===e.tagName){const t=e.getBoundingClientRect(),n=r.width/t.width,s=r.height/t.height,i=r.left-t.left,a=r.top-t.top;e.style.transform=`translate(${i}px, ${a}px) scale(${n}, ${s})`}e.style.opacity=0,e.style.transition=`transform ${S}ms ${c.transitionTimingFunction}, opacity ${S}ms ${c.transitionTimingFunction} ${S/2}ms`}));const r=()=>{G(u),p.close(),p.classList.remove("parvus--is-closing"),p.classList.remove("parvus--is-vertical-closing"),e.style.transform="",e.removeEventListener("transitionend",r),a[d].slider.remove(),a[d].slider=null,a[d].sliderElements=[],a[d].contentElements=[],w.removeAttribute("aria-hidden"),E.removeAttribute("aria-hidden"),E.removeAttribute("aria-disabled"),A.removeAttribute("aria-hidden"),A.removeAttribute("aria-disabled"),c.hideScrollbar&&(document.body.style.marginInlineEnd="",document.body.style.overflow="")};e.addEventListener("transitionend",r,{once:!0})},D=e=>{e<0||e>=a[d].triggerElements.length||void 0!==a[d].sliderElements[e]||(F(e),P(a[d].triggerElements[e],e,(()=>{R(e)})))},O=e=>{a[d].sliderElements[e].setAttribute("aria-hidden","false")},P=(e,t,r)=>{const{contentElements:n,sliderElements:s}=a[d];if(void 0!==n[t])return void(r&&"function"==typeof r&&r());const i=s[t].querySelector("div"),o=new Image,l=document.createElement("div"),u=e.querySelector("img"),p=document.createElement("div");l.className="parvus__content",p.className="parvus__loader",p.setAttribute("role","progressbar"),p.setAttribute("aria-label",c.l10n.lightboxLoadingIndicatorLabel),i.appendChild(p);new Promise(((e,t)=>{o.onload=()=>e(o),o.onerror=e=>t(e)})).then((r=>{r.style.opacity=0,l.appendChild(r),i.appendChild(l),c.captions&&((e,t,r,n)=>{const s=document.createElement("div");let i=null;if(s.className="parvus__caption","self"===c.captionsSelector)r.hasAttribute(c.captionsAttribute)&&""!==r.getAttribute(c.captionsAttribute)&&(i=r.getAttribute(c.captionsAttribute));else{const e=r.querySelector(c.captionsSelector);null!==e&&(i=e.hasAttribute(c.captionsAttribute)&&""!==e.getAttribute(c.captionsAttribute)?e.getAttribute(c.captionsAttribute):e.innerHTML)}if(null!==i){const r=`parvus__caption-${n}`;s.id=r,s.innerHTML=`<p>${i}</p>`,e.appendChild(s),t.setAttribute("aria-describedby",r)}})(i,o,e,t),n[t]=r,r.setAttribute("width",r.naturalWidth),r.setAttribute("height",r.naturalHeight),re(s[t],r)})).catch((()=>{const e=document.createElement("div");e.classList.add("parvus__content"),e.classList.add("parvus__content--error"),e.innerHTML=`${c.l10n.lightboxLoadingError}`,i.appendChild(e),n[t]=e})).finally((()=>{i.removeChild(p),r&&"function"==typeof r&&r()})),e.hasAttribute("data-sizes")&&""!==e.getAttribute("data-sizes")&&o.setAttribute("sizes",e.getAttribute("data-sizes")),e.hasAttribute("data-srcset")&&""!==e.getAttribute("data-srcset")&&o.setAttribute("srcset",e.getAttribute("data-srcset")),"A"===e.tagName?o.setAttribute("src",e.href):o.setAttribute("src",e.getAttribute("data-target")),u&&u.hasAttribute("alt")&&""!==u.getAttribute("alt")?o.alt=u.alt:e.hasAttribute("data-alt")&&""!==e.getAttribute("data-alt")?o.alt=e.getAttribute("data-alt"):o.alt=""},R=(e,t)=>{const r=a[d].contentElements[e];if(r&&"IMG"===r.tagName){const n=a[d].triggerElements[e];if(t){const e=r.getBoundingClientRect(),t=n.getBoundingClientRect(),s=t.width/e.width,i=t.height/e.height,a=t.left-e.left,o=t.top-e.top;requestAnimationFrame((()=>{r.style.transform=`translate(${a}px, ${o}px) scale(${s}, ${i})`,r.style.transition="transform 0s, opacity 0s",requestAnimationFrame((()=>{r.style.transform="",r.style.opacity="",r.style.transition=`transform ${S}ms ${c.transitionTimingFunction}, opacity ${S/2}ms ${c.transitionTimingFunction}`}))}))}else r.style.opacity=""}else r.style.opacity=""},j=e=>{const t=u;if(!he())throw new Error("Oops, I'm closed.");{if("number"!=typeof e||isNaN(e))throw new Error("Oops, no slide specified.");const t=a[d].triggerElements;if(e===u)throw new Error(`Oops, slide ${e} is already selected.`);if(e<-1||e>=t.length)throw new Error(`Oops, I can't find slide ${e}.`)}void 0!==a[d].sliderElements[e]||(F(e),P(a[d].triggerElements[e],e,(()=>{R(e)}))),O(e),u=e,K(),e<t?(V(),D(e-1)):e>t&&(V(),D(e+1)),G(t),J(),be("select")},U=()=>{u>0&&j(u-1)},W=()=>{const{triggerElements:e}=a[d];u<e.length-1&&j(u+1)},G=e=>{void 0!==a[d].sliderElements[e]&&a[d].sliderElements[e].setAttribute("aria-hidden","true")},K=()=>{d=null!==d?d:l,$=-u*p.offsetWidth,a[d].slider.style.transform=`translate3d(${$}px, 0, 0)`,k=$},V=()=>{const{triggerElements:e}=a[d],t=e.length,r=u===t-1;t>1&&(0===u?(E.setAttribute("aria-disabled","true"),A.removeAttribute("aria-disabled")):r?(E.removeAttribute("aria-disabled"),A.setAttribute("aria-disabled","true")):(E.removeAttribute("aria-disabled"),A.removeAttribute("aria-disabled")))},J=()=>{w.textContent=`${u+1}/${a[d].triggerElements.length}`},Q=()=>{L={startX:0,endX:0,startY:0,endY:0}},Z=()=>{const{startX:e,startY:t,endX:r,endY:n}=L,s=r-e,i=n-t,o=Math.abs(s),l=Math.abs(i),{triggerElements:g}=a[d],h=g.length;_?s>2&&o>=c.threshold&&u>0?U():s<2&&o>=c.threshold&&u!==h-1?W():K():C?(l>2&&c.swipeClose&&l>=c.threshold?H():(p.classList.remove("parvus--is-vertical-closing"),K()),m.style.opacity=""):K()},ee=()=>{const e=a[d].triggerElements.length,t=a[d].slider,r=a[d].sliderElements,n=c.simulateTouch||ve(),s=t.classList.contains("parvus__slider--is-draggable");n&&c.swipeClose&&!s||n&&e>1&&!s?t.classList.add("parvus__slider--is-draggable"):t.classList.remove("parvus__slider--is-draggable"),e>1?(t.setAttribute("role","region"),t.setAttribute("aria-roledescription","carousel"),t.setAttribute("aria-label",c.l10n.sliderLabel),r.forEach(((t,r)=>{t.setAttribute("role","group"),t.setAttribute("aria-label",`${c.l10n.slideLabel} ${r+1}/${e}`)}))):(t.removeAttribute("role"),t.removeAttribute("aria-roledescription"),t.removeAttribute("aria-label"),r.forEach((e=>{e.removeAttribute("role"),e.removeAttribute("aria-label")}))),1===e?(w.setAttribute("aria-hidden","true"),E.setAttribute("aria-hidden","true"),A.setAttribute("aria-hidden","true")):(w.removeAttribute("aria-hidden"),E.removeAttribute("aria-hidden"),A.removeAttribute("aria-hidden"))},te=()=>{I||(I=!0,s.requestAnimationFrame((()=>{a[d].sliderElements.forEach(((e,t)=>{re(e,a[d].contentElements[t])})),K(),I=!1})))},re=(e,t)=>{if("IMG"!==t.tagName)return;const r=getComputedStyle(e),n=e.querySelector(".parvus__caption"),s=n?n.getBoundingClientRect().height:0,i=t.getAttribute("height"),a=t.getAttribute("width");let o=e.offsetHeight,l=e.offsetWidth;o-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)+parseFloat(s),l-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);const d=Math.min(l/a||0,o/i),u=a*d||0,c=i*d||0;i>c&&i<o&&a>u&&a<l||i<c&&i<o&&a<u&&a<l?(t.style.width="",t.style.height=""):(t.style.width=`${u}px`,t.style.height=`${c}px`)},ne=function(e){e.preventDefault(),z(this)},se=e=>{const{target:t}=e;t===E?U():t===A?W():(t===y||c.docClose&&!C&&!_&&t.classList.contains("parvus__slide"))&&H(),e.stopPropagation()},ie=t=>{const r=(n=p,Array.from(n.querySelectorAll(e.join(", "))).filter((e=>null!==e.offsetParent)));var n;const s=r.indexOf(document.activeElement),i=r.length-1;switch(t.code){case"Tab":t.shiftKey?0===s&&(r[i].focus(),t.preventDefault()):s===i&&(r[0].focus(),t.preventDefault());break;case"Escape":H(),t.preventDefault();break;case"ArrowLeft":U(),t.preventDefault();break;case"ArrowRight":W(),t.preventDefault()}},ae=e=>{e.preventDefault(),e.stopPropagation(),_=!1,C=!1,x=!0;const{pageX:t,pageY:r}=e;L.startX=t,L.startY=r;const{slider:n}=a[d];n.classList.add("parvus__slider--is-dragging"),n.style.willChange="transform",g=getComputedStyle(m).opacity},oe=e=>{if(e.preventDefault(),x){const{pageX:t,pageY:r}=e;L.endX=t,L.endY=r,pe()}},le=e=>{e.stopPropagation(),x=!1;const{slider:t}=a[d];t.classList.remove("parvus__slider--is-dragging"),t.style.willChange="",(L.endX||L.endY)&&Z(),Q()},de=e=>{e.stopPropagation(),_=!1,C=!1;const{clientX:t,clientY:r}=e.changedTouches[0];L.startX=parseInt(t,10),L.startY=parseInt(r,10);const{slider:n}=a[d];n.classList.add("parvus__slider--is-dragging"),n.style.willChange="transform",g=getComputedStyle(m).opacity},ue=e=>{e.preventDefault(),e.stopPropagation();const{clientX:t,clientY:r}=e.changedTouches[0];L.endX=parseInt(t,10),L.endY=parseInt(r,10),pe()},ce=e=>{e.stopPropagation();const{slider:t}=a[d];t.classList.remove("parvus__slider--is-dragging"),t.style.willChange="",(L.endX||L.endY)&&Z(),Q()},pe=()=>{const{startX:e,endX:t,startY:r,endY:n}=L,s=e-t,i=n-r,o=Math.abs(i);Math.abs(s)>2&&!C&&a[d].triggerElements.length>1?(a[d].slider.style.transform=`translate3d(${k-Math.round(s)}px, 0, 0)`,_=!0,C=!1):Math.abs(i)>2&&!_&&c.swipeClose&&(!M&&o<=100&&(m.style.opacity=g-o/100),p.classList.add("parvus--is-vertical-closing"),a[d].slider.style.transform=`translate3d(${k}px, ${Math.round(i)}px, 0)`,_=!1,C=!0)},me=()=>{s.addEventListener("keydown",ie),s.addEventListener("resize",te),s.addEventListener("popstate",H),T.addEventListener("change",B),p.addEventListener("click",se),ve()&&(p.addEventListener("touchstart",de),p.addEventListener("touchmove",ue),p.addEventListener("touchend",ce)),c.simulateTouch&&(p.addEventListener("mousedown",ae),p.addEventListener("mouseup",le),p.addEventListener("mousemove",oe))},ge=()=>{s.removeEventListener("keydown",ie),s.removeEventListener("resize",te),s.removeEventListener("popstate",H),T.removeEventListener("change",B),p.removeEventListener("click",se),ve()&&(p.removeEventListener("touchstart",de),p.removeEventListener("touchmove",ue),p.removeEventListener("touchend",ce)),c.simulateTouch&&(p.removeEventListener("mousedown",ae),p.removeEventListener("mouseup",le),p.removeEventListener("mousemove",oe))},he=()=>p.hasAttribute("open"),ve=()=>"ontouchstart"in window,be=e=>{const t=new CustomEvent(e,{cancelable:!0});p.dispatchEvent(t)},fe=()=>{if(c=(e=>{const t={selector:".lightbox",gallerySelector:null,captions:!0,captionsSelector:"self",captionsAttribute:"data-caption",docClose:!0,swipeClose:!0,simulateTouch:!0,threshold:50,hideScrollbar:!0,transitionDuration:300,transitionTimingFunction:"cubic-bezier(0.62, 0.16, 0.13, 1.01)",lightboxIndicatorIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3"/></svg>',previousButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18" /></svg>',nextButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="9 6 15 12 9 18" /></svg>',closeButtonIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" stroke="currentColor"><path d="M18 6L6 18M6 6l12 12"/></svg>',l10n:n},r={...t,...e};return e&&e.l10n&&(r.l10n={...t.l10n,...e.l10n}),r})(t),B(),null!==c.gallerySelector){document.querySelectorAll(c.gallerySelector).forEach(((e,t)=>{const r=t;e.querySelectorAll(c.selector).forEach((e=>{e.setAttribute("data-group",`parvus-gallery-${r}`),q(e)}))}))}document.querySelectorAll(`${c.selector}:not(.parvus-trigger)`).forEach(q)};return fe(),{init:fe,open:z,close:H,select:j,previous:U,next:W,currentIndex:()=>u,add:q,remove:X,destroy:()=>{if(!p)return;he()&&H(),p.remove();document.querySelectorAll(".parvus-trigger").forEach(X),be("destroy")},isOpen:he,on:(e,t)=>{p&&p.addEventListener(e,t)},off:(e,t)=>{p&&p.removeEventListener(e,t)}}}export{s as default};
